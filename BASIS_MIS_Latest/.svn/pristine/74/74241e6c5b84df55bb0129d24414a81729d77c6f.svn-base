0010 REM "ARE - SIMPLE INVOICE ENTRY/DETAIL"
0020 REM "Program ARE.FC"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM 
0045 SETESC 9000
0050 SETERR 9000
0060 PRECISION 5
0100 REM " --- Open Files 
0200 REM " --- IOLists
0220 ARE05A: IOLIST B0$,B1$
0230 ARE15A: IOLIST C0$,C1$,C[ALL]
0240 GLM01A: IOLIST ACT1$,ACTNAM$(1)
0500 REM " --- Init Data
0520 DIM C0$(12),C1$(60),C[2]
0530 LET L9=19,L1=13
0540 LET R8=12
0560 DIM R0$(R8*(L9-L1+2))
0570 LET C0$(1,9)=B0$(1,9)
0580 LET C1$(13+G[4],6)=F0$(17,6)
0700 REM " --- Background
1900 REM " --- Init File
1920 READ (ARE15_DEV,KEY=B0$(1,9),DOM=1930)
1930 LET C1$(1,G[3])=W1$(21,10)
1940 GOSUB 5200
2000 REM " --- Default
2010 LET V2$="",V2$=KEY(ARE15_DEV,END=2050)
2020 IF V2$(1,9)<>B0$(1,9) THEN LET V2$=""
2030 IF V2$<>"" THEN LET C0$(10,3)=V2$(10)
2040 IF V2$<>"" THEN GOTO 2100
2050 LET X=NUM(C0$(10,3))+1
2060 IF X>999 THEN LET X=1
2070 LET C0$(10,3)=STR(X:"000")
2100 REM " --- New Line?
2120 IF L<=L9 THEN GOTO 2200
2140 LET R0=1
2150 GOSUB 6400
2190 LET L=L9
2200 REM " --- Seq
2220 LET V0$="Z",V1$="KRE",V2$=C0$(10,3),V0=3,V1=0,V2=L,I0=0
2230 GOSUB 7000
2240 IF V3=4 THEN PRINT @(0,L),"   "; GOTO 4000
2250 LET C0$(10,3)=V$
2260 IF V=0 THEN GOTO 2200
2290 GOTO 3900
2400 REM " --- Fine Record
2405 LET C1$(1,G[4])=DEFACT$,C1$(G[4]+1)=B1$(1,6)
2410 DIM C[2]
2420 EXTRACT (ARE15_DEV,KEY=C0$,DOM=3900)IOL=ARE15A
2430 LET X0=POS(C0$(1,R8)=R0$,R8)
2440 IF X0=0 THEN GOTO 2500
2460 LET R0=INT(X0/R8)+1
2470 GOSUB 6400
2480 IF L>L1 THEN LET L=L-2
2500 GOSUB 5000
2590 GOTO 3500
2700 REM " --- GL #
2710 IF GL$<>"Y" THEN GOTO 2790
2720 LET V0$="M",V1$="C",V2$=C1$(1,G[3]),V3$=G1$,V0=G[4],V1=4,V2=L
2725 LET V4$="Enter A Valid G/L Account, <F3>=Lookup"
2730 GOSUB 7000
2735 IF V3=3 THEN CALL "SYC.LG",V$
2738 IF V$="" THEN GOTO 2700
2740 DIM ACTNAM$(40)
2750 FIND (GLM01_DEV,KEY=N0$+V$,DOM=2700)IOL=GLM01A
2755 LET C1$(1,G[4])=V$
2760 PRINT @(V1,V2),FNF$(C1$(1,G[3]),G1$),@(V1+G5+1,V2),ACTNAM$(1,35),
2790 GOTO 3900
2800 REM " --- Date
2820 LET V0$="D",V1$="R6N",V2$=C1$(1+G[4],6),V0=8,V1=1,V2=L+1
2840 GOSUB 7000
2850 IF V3=2 THEN GOTO 2890
2860 LET C1$(G[4]+1,6)=V$
2890 GOTO 3900
2900 REM " --- Memo
2920 LET V0$="S",V2$=C1$(G[4]+7,30),V0=30,V1=10,V2=L+1
2940 GOSUB 7000
2960 LET C1$(G[4]+7,30)=V$
2990 GOTO 3900
3000 REM " --- Units
3020 LET V0$="N",V2$=STR(C[0]),V3$=M2$,V1=O[0],V2=L+1
3040 GOSUB 7000
3060 LET C[0]=V
3090 GOTO 3900
3100 REM " --- Rate
3120 LET V0$="N",V2$=STR(C[1]),V3$=M3$,V1=O[1],V2=L+1
3140 GOSUB 7000
3160 LET C[1]=V
3165 IF V3=3 THEN LET C[1]=-C[1]; PRINT @(V1,V2),C[1]:M3$,
3168 PRECISION 2
3170 LET C[2]=C[1]*C[0]
3172 PRECISION 5
3180 PRINT @(O[2],L+1),C[2]:M1$,
3190 GOTO 3900
3200 REM " --- Ext
3220 LET V0$="N",V2$=STR(C[2]),V3$=M1$,V1=O[2],V2=L+1
3240 GOSUB 7000
3250 PRECISION 2
3260 LET C[2]=V*1
3270 PRECISION 5
3290 GOTO 3900
3500 REM " --- Correct
3520 LET V0$="S",V1$="C",V2$="",V0=1,V1=78,V2=L,I0=8
3525 LET V4$="<Enter>=OK, <F2>=Modify, <D>=Delete"
3530 GOSUB 7000
3540 IF V3=2 THEN GOTO 3900
3550 IF V$<>"" THEN GOTO 3600
3560 WRITE (ARE15_DEV,KEY=C0$(1,R8))IOL=ARE15A
3570 LET R0$(R8*(L-L1)+1,R8)=C0$(1,R8)
3580 LET L=L+2
3590 GOTO 3700
3600 IF V$<>"D" THEN GOTO 3500
3620 REMOVE (ARE15_DEV,KEY=C0$(1,R8),DOM=3630)
3630 LET R0=L-L1+1
3640 GOSUB 6400
3650 PRINT @(0,L),'CL',
3690 GOTO 3900
3900 REM " --- Next Field
3910 IF V3<>2 THEN GOTO 3940
3920 IF I0>0 THEN LET I0=I0-1
3930 GOTO 3950
3940 LET I0=I0+1
3960 ON I0 GOTO 2200,2400,2700,2800,2900,3000,3100,3200,3500,2000
4000 REM " --- Overlay
4010 LET V0$="S",V1$="KC",V2$="",V3$="",V4$="Is The Above Information Correct (Y/N/List/Review/Total/Delete)? ",V0=6,V1=FNV(V4$),V2=22
4020 GOSUB 7000
4040 IF V$="Y" THEN RUN "ARE.FB"
4050 IF V$="N" THEN GOTO 2000
4055 IF V$="R" OR V$="Review" THEN LET V$="REVIEW" ELSE IF V$="L" OR V$="List" THEN LET V$="LIST"
4060 IF V$="LIST" THEN GOTO 4400
4070 IF V$="REVIEW" THEN GOTO 4600
4080 IF V$="DELETE" THEN GOTO 4200
4085 IF V$="TOTAL" THEN GOTO 4500
4090 GOTO 4000
4200 REM " --- Delete
4220 READ (ARE15_DEV,KEY=B0$(1,9),DOM=4230)
4230 LET K$=KEY(ARE15_DEV,END=4300)
4240 IF K$(1,9)<>B0$(1,9) THEN GOTO 4300
4250 REMOVE (ARE15_DEV,KEY=K$)
4260 GOTO 4230
4300 LET B1$(17,1)="V"
4320 WRITE (ARE05_DEV,KEY=B0$)IOL=ARE05A
4390 RUN "ARE.FB"
4400 REM " --- List
4420 GOSUB 5200
4490 GOTO 4000
4500 REM " --- Total
4505 LET T0=0,T2=0
4510 READ (ARE15_DEV,KEY=B0$(1,9),DOM=4520)
4520 LET K$=KEY(ARE15_DEV,END=4570)
4530 IF K$(1,9)<>B0$(1,9) THEN GOTO 4570
4540 READ (ARE15_DEV)IOL=ARE15A
4550 LET T0=T0+C[0],T2=T2+C[2]
4560 GOTO 4520
4570 PRINT @(0,22),'CL',@(10),"***Totals:",@(40),T0:M2$,@(40+M2+M3),T2:M1$,
4575 PRINT @(73,22),"<Enter>:",
4580 LET V0$="S",V1$="C",V2$="",V3$="",V4$="",V0=1,V1=79,V2=22
4585 GOSUB 7000
4590 GOTO 4000
4600 REM " --- Review
4610 GOSUB 6000
4620 READ (ARE15_DEV,KEY=B0$(1,9),DOM=4630)
4640 LET L=L1
4690 GOTO 2000
5000 REM " --- Display Line
5010 PRINT @(0,L),C0$(10,3),
5020 IF GL$="Y" THEN GOSUB 5400
5050 PRINT @(1,L+1),FNB6$(C1$(1+G[4],6)),@(10),C1$(7+G[4],30),@(O[0]),C[0]:M2$,@(O[1]),C[1]:M3$,@(O[2]),C[2]:M1$,
5080 LET R0$(R8*(L-L1)+1,R8)=C0$(1,R8)
5090 RETURN 
5200 REM " --- Display All
5205 GOSUB 6000
5210 LET L=L1
5220 READ (ARE15_DEV,KEY=B0$(1,9),DOM=5230)
5230 LET K$=KEY(ARE15_DEV,END=5390)
5240 IF K$(1,9)<>B0$(1,9) THEN GOTO 5390
5260 READ (ARE15_DEV)IOL=ARE15A
5270 IF L<=L9 THEN GOTO 5320
5275 LET V0$="S",V1$="CE",V2$="",V3$="",V4$="<Enter>=Continue  <F4>=End ",V0=1,V1=FNV(V4$),V2=22
5280 GOSUB 7000
5290 IF V3=4 THEN EXITTO 4000
5300 GOSUB 6000
5310 LET L=L1
5320 GOSUB 5000
5330 LET L=L+2
5340 GOTO 5230
5390 RETURN 
5400 REM " --- Display GL Account
5420 DIM ACTNAM$(40)
5430 LET ACTNAM$(1)="**Not On File**"
5432 FIND (GLM01_DEV,KEY=N0$+C1$(1,G[4]),DOM=5040)IOL=GLM01A
5440 PRINT @(4,L),FNF$(C1$(1,G[3]),G5$)," ",ACTNAM$(1,35),
5490 RETURN 
6000 REM " --- Clear Lower Screen
6020 PRINT @(0,L1),'CE',
6040 LET R0$(1)=""
6090 RETURN 
6400 REM " --- Remove Key
6420 IF R0=1 THEN LET R0$(1)=R0$(R8*2+1)
6430 IF R0=L9 THEN LET R0$(R8*(L9-L1)+1,R8)=""
6440 IF R0>1 THEN IF R0<L9 THEN LET R0$(1)=R0$(1,R8*(R0-1))+R0$(R8*(R0+1)+1)
6450 PRINT @(0,21),'LI','LI',@(0,R0+L1-1),'LD','LD',
6490 RETURN 
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM " --- Functions
8025 DEF FNB6$(Q1$)=Q1$(3,2)+"/"+Q1$(5,2)+"/"+FNYY21_YY$(Q1$(1,2))
8095 DEF FNV(Q$)=42+INT(LEN(Q$)/2)
8145 REM " --- FNYY21_YY$ Un-Convert 21st Century 2-Char Year to 2-Char Year"
8150 DEF FNYY21_YY$(Q1$)
8155 LET Q3$=" 01234567890123456789",Q1$(1,1)=Q3$(POS(Q1$(1,1)=" 0123456789ABCDEFGHIJ"))
8160 RETURN Q1$
8165 FNEND
8200 REM " --- FNF$ AlphaNumeric Masking Function"
8210 DEF FNF$(Q1$,Q2$)
8220 IF Q2$="" THEN LET Q2$=FILL(LEN(Q1$),"0")
8230 RETURN STR(-NUM(Q1$,ERR=ALPHA_FNF):Q2$,ERR=ALPHA_FNF)
8240 ALPHA_FNF: 
8245 LET Q=1,Q0=0
8250 WHILE LEN(Q2$(Q))
8255 IF POS(Q2$(Q,1)="-()") THEN LET Q0=Q0+1 ELSE LET Q2$(Q,1)="X"
8260 LET Q=Q+1
8265 WEND
8270 IF LEN(Q1$)>LEN(Q2$)-Q0 THEN LET Q1$=Q1$(1,LEN(Q2$)-Q0)
8280 RETURN STR(Q1$:Q2$)
8290 FNEND
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 RUN "SYS.AA"
9999 END
