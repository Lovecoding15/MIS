0010 REM BLK.18
0020 BEGIN 
0030 SETERR 9000
0040 SETESC 9000
0050 LET SYS01T=UNT; OPEN (SYS01T)"SYS-01"
0060 LET TERMINAL$="T"+FID(0)
0070 READ (SYS01T,KEY=TERMINAL$)*,F0$; CLOSE (SYS01T)
0080 PRINT @(0,3),'CE'
0090 PRINT 'SB',@(20,3),"Beginning Serial#:",@(23,5),"Ending Serial#:",
0100 PRINT 'SB',@(12,11),"Print/Email/Fax (P/E/F):",'SF',
0110 START_SN: 
0120 LET V0$="S",V1$="CE^",V2$="",V3$="",V4$="",V0=9,V1=40,V2=3,I0=0
0130 GOSUB 7000; IF V3=4 THEN GOTO 9900
0140 LET V$=V$+FILL(V0); LET V$=V$(1,V0)
0150 IF V$=FILL(V0) THEN LET START_SNUM$="",END_SNUM$=""; GOTO CHOOSE
0160 PRINT @(V1,V2),V$; LET START_SNUM$=V$
0170 END_SN: 
0180 LET V0$="S",V1$="CE^",V2$=V$,V3$="",V4$="",V0=9,V1=40,V2=5,I0=0
0190 GOSUB 7000; IF V3=4 THEN GOTO 9900
0200 LET V$=V$+FILL(V0); LET V$=V$(1,V0)
0210 IF V$=FILL(V0) THEN LET V$=START_SNUM$
0220 IF V$<START_SNUM$ THEN GOTO END_SN
0230 PRINT @(V1,V2),V$(1,7); LET END_SNUM$=V$
0240 CHOOSE: 
0250 LET V0$="S",V1$="CE^",V2$="",V3$="",V4$="",V0=1,V1=40,V2=11,I0=0
0260 GOSUB 7000; IF V3=4 THEN GOTO 9900
0270 IF POS(V$="PEF")=0 OR LEN(V$)<>1 THEN GOTO CHOOSE
0280 PRINT @(V1,V2),V$; LET CHOICE$=V$
0300 REM " --- Correct "
0310 LET V4$="Is The Above Information Correct",V0=1,V1=42+INT(LEN(V4$)/2),V2=22
0320 CALL "SYC.YN",1,V4$,2,V$,V3
0330 IF V3=4 THEN GOTO 9900
0340 ON POS(V$="YN") GOTO 0140,0350,0110
0350 RUN "BLK.20"
6000 REM 6000 " --- Alpha Search "
6010 CALL "SYC.LC",V$
6020 IF V$<>"" THEN PRINT @(V1,V2),V$(1,7),'CL',
6030 RETURN 
7000 REM 7000 " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7140
7030 IF V3=127 THEN GOTO 7100
7040 RETURN 
7100 REM 7100 " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7140,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7140 REM " --- Error During Input"
7150 ESCAPE
7160 GOTO 7000
9000 REM 9000 " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9060,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9070
9040 IF E1=3 THEN GOTO 9090
9050 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9060 ESCAPE
9070 REM " --- Retry"
9080 RETRY
9090 REM " --- Return"
9100 SETERR 9000
9110 GOTO 9900
9300 REM 9300 " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9340,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9350
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9340 ESCAPE
9350 RETURN 
9800 REM 9800 " --- Display Parameter record error"
9810 LET LINE_ERR$=LST(PGM(TCB(5)))
9820 CALL "SYC.YA",LINE_ERR$,N2$,ERR
9900 REM 9900
9910 RUN "SYS.AA"
9920 END
