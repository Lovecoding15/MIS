0010 REM "SYC - SpeedSearch Desktop Interface"
0020 REM "Program SYC.QO"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM 
0045 REM "D_STATUS  : SpeedSearch Status (0=No Error)"
0050 REM "OPTION$[n]: Standard SpeedSearch Options Array"
0055 REM 
0080 SETERR 9000
0085 SETESC 9000
0090 ENTER D_STATUS,OPTION$[ALL]
0400 REM " --- Parameters"
0410 DIM SPEED$(128)
0420 LET SPEED$(1)=STBL("!SPEEDSEARCH",ERR=9900),MAXOPT=NUM(SPEED$(57,2))
0475 LET ONAME$=FNP$(SPEED$(27,8)),OWIDTH=NUM(SPEED$(83,2))
0500 REM " --- Initializations"
0510 DIM OPTLIST$[2,MAXOPT,6]
0540 LET D_STATUS=0,PGM$=PGM(-2),OPTION=0
0600 REM " --- Option Window"
0610 CALL "SYC.QC",SYM01_DEV,SYM11_DEV,PGM$,SECURITY$,OPTION,OPTLIST$[ALL],TITLE$,MAXROW,PREVMENU$,NAME$
2000 REM " --- Option window processing"
2010 GOSUB 5500
2020 IF TYPE$<>"Y" THEN GOTO 4000
3000 REM " --- Create full-screen borderless window and exit to O/S"
3010 CALL "SYC.WA",1,82,26,-1,-1,"",NAME$
3020 LET COMMAND$=OPTION$[1],OPTION$[1]="EXIT"
3030 PRINT 'CURSOR'("ON"),
3040 CALL "SYC.OS",ERR=3050,COMMAND$
3050 PRINT 'CS','CURSOR'("OFF"),
3080 CALL "SYC.WD",NAME$
3090 GOTO 2000
4000 REM " --- All done"
4090 GOTO 9900
5500 REM " --- Option window processing"
5510 DIM MORE$[1,MAXOPT,1]
5520 LET TYPE$="",PAGE=1
5530 CALL "SYC.WB",ONAME$,0
5600 REM " --- Call lightbar routine"
5610 CALL "SYC.SA",0,OPTLIST$[ALL],MORE$[ALL],ANSWER$,PAGE,MAXROW,ONAME$,OHEIGHT,OWIDTH,FKEY
5620 IF FKEY=4 THEN GOTO 5800
5630 IF FKEY=5 THEN GOTO 5850
5640 IF ANSWER$="END" THEN GOTO 5800
5650 FOR X=1 TO OPTION
5660 IF OPTLIST$[1,X,2]<>ANSWER$ THEN GOTO 5690
5670 LET OPTION$[2]=OPTLIST$[1,X,3],TYPE$=OPTLIST$[1,X,4],SELECTION=X
5680 LET SECURITY$=OPTLIST$[1,X,5],PASSWORD$=OPTLIST$[1,X,6]
5690 NEXT X
5700 REM " --- Security OK?"
5710 IF SECURITY$="" AND PASSWORD$="" THEN GOTO 5750
5720 CALL "SYC.QX","","",SELECTION,OPTLIST$[ALL],STATUS
5730 IF STATUS>0 THEN GOTO 5600
5750 REM " --- Do now?"
5760 LET OPTION$[1]=FNP$(ANSWER$),OPTION$[3]=""
5770 IF OPTION$[2]<>"CALL NOW" THEN GOTO 5900
5780 CALL FNP$(OPTION$[1]),ERR=5600,NAME$
5790 GOTO 5600
5800 REM " --- <F4> Exit"
5810 LET OPTION$[1]="EXIT"
5850 REM " --- <F5> SpeedSearch"
5860 LET OPTION$[1]="STARTOVER"
5890 GOTO 5900
5900 REM " --- Option processing completed"
5990 RETURN 
8000 REM " --- Function Definitions"
8080 DEF FNP$(Q$)=CVS(Q$,2)
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 REM " --- Return to caller"
9950 EXIT 
9999 END
