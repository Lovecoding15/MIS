0010 REM "BMM - Bill Maintenance - Delete
0020 REM "Program BMM.ME"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM 
0085 SETESC 9000
0090 SETERR 9000
0200 REM "--- IOLists
0220 BMM02A: IOLIST D$,D1$
0230 BMM03A: IOLIST D$,D1$
0250 BMM05A: IOLIST D$,D1$
0800 REM " --- Options
0805 CALL "SYC.YN",0,"Do You Wish To Delete This Bill Of Material",0,V$,V3
0817 PRINT @(0,15),'CL',
0820 IF V$="NO" THEN GOTO 5000
0830 IF V$="YES" THEN GOTO 0850
0840 GOTO 0800
0850 PRINT @(10,15),'CL',"Now Deleting Bill Of Material......",
0860 REM " --- Remove BMM-02 / BMM-04
0890 READ (BMM02_DEV,KEY=A0$(1,22),DOM=0900)
0900 READ (BMM02_DEV,END=1000)IOL=BMM02A
0910 IF POS(A0$(1,22)=D$)<>1 THEN GOTO 1000
0920 REMOVE (BMM04_DEV,KEY=D$(1,2)+D1$+D$(3),DOM=0930)
0930 REMOVE (BMM02_DEV,KEY=D$,DOM=0940)
0940 GOTO 0900
1000 REM " --- Remove BMM-03 / BMM-06
1110 READ (BMM03_DEV,KEY=A0$(1,22),DOM=1120)
1120 READ (BMM03_DEV,END=1300)IOL=BMM03A
1150 IF POS(A0$(1,22)=D$)<>1 THEN GOTO 1300
1200 REMOVE (BMM03_DEV,KEY=D$,DOM=1210)
1220 REMOVE (BMM06_DEV,KEY=D$(1,2)+D1$(1,3)+D$(3),DOM=1240)
1240 GOTO 1120
1300 REM " --- Remove BMM-05
1310 READ (BMM05_DEV,KEY=A0$(1,22),DOM=1320)
1320 READ (BMM05_DEV,END=1500)IOL=BMM05A
1330 IF POS(A0$(1,22)=D$)<>1 THEN GOTO 1500
1340 REMOVE (BMM05_DEV,KEY=D$,DOM=1341)
1390 GOTO 1320
1500 REM " --- Remove BMM-09 Comments
1590 READ (BMM09_DEV,KEY=A0$(1,22),DOM=1600)
1600 REM " --- Loop thru BMM-09 records"
1610 LET K$=KEY(BMM09_DEV,END=2000)
1620 IF POS(A0$(1,22)=K$)<>1 THEN GOTO 2000
1630 REMOVE (BMM09_DEV,KEY=K$)
1690 GOTO 1600
2000 REM " --- Remove BMM-01
2200 REMOVE (BMM01_DEV,KEY=A0$(1,22),DOM=2210)
4000 BEGIN 
4040 RUN "BMM.MA"
5000 LET O0=1
5020 RUN "BMM.MA"
8000 REM " --- Functions
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 RUN "SYS.AA"
9999 END
