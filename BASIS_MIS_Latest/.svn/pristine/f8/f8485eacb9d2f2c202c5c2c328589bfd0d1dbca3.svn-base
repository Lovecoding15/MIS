0010 REM "TMM - Create Telemarketing Contacts from Customer Master"
0020 REM "Program TMx.AA"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 5.2.0 - 01May94 |"
0026 REM "|      Copyright (c) 1994 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM "COPYRIGHT (C) 1991 MicroAccounting Systems, Inc. ALL RIGHTS RESERVED"
0041 REM 
0042 REM "01/03/96 KJS WA: #221 ADS
0079 REM 
0080 BEGIN 
0090 SETERR 9000
0100 REM "OPEN/LOCK FILES"
0110 OPEN (1)"ARM-01"
0120 OPEN (2)"TMM-01"
0130 OPEN (3)"TMM-02"
0140 OPEN (4)"ARM-04"
0150 OPEN (5)"ARM-02"
0160 OPEN (6)"SYS-01"
0190 OPEN (10)"ARM-10"
0200 REM "IOLISTS"
0210 ARM01A: IOLIST B0$(1),B1$(1)
0265 ARS01B: IOLIST C9$(1)
0400 REM " --- Parameters"
0401 GOSUB 62000; REM "WA: #221
0405 DIM P[2],C9$(36)
0420 LET N0$=PRM$[FID,TFIRM],N1$=PRM$[FID,TFNAME],N2$="AR",N4$=PRM$[FID,TPNAME],C9$(7,1)="N"; REM "WA: #221
0440 FIND (6,KEY=N0$+N2$+"01",DOM=0450)IOL=ARS01B
0490 LET P[0]=NUM(PRM$[AR,KEYLEN]),P[1]=NUM(PRM$[AR,KEYMAX]),P[2]=NUM(PRM$[AR,THREE](4,1)); REM "WA: #221
0500 REM "INIT DATA"
0510 DIM J0$(20,"0"),J$(80,"-"),J1$(80," ")
0520 DIM B0$(8),B1$(305),E[5]
0540 LET B0$(1,2)=N0$,CLS$="N"
0550 LET M8$="(###)-###-####",M9$="###-##-####",M7$="00000"
0560 CALL "SYC.RM",M1$,M1,11,14
0570 IF P[2]=9 THEN LET M7$="00000-0000"
0580 LET ARM01_DEV=1,TMM01_DEV=2,TMM02_DEV=3,ARM04_DEV=4
0600 REM " --- Other file opens"
0700 REM "BACKGROUND"
0710 PRINT 'CF'
0720 FOR X=4 TO 12 STEP 2
0730 CALL "SYC.WC",1,0,80,0,0,X,0
0740 NEXT X
0750 PRINT 'SB',@(20,3),"Beginning Customer:",@(23,5),"Ending Customer:",@(15,7),"Beginning Customer Type:",@(18,9),"Ending Customer Type:",@(30,11),"Printing:",'SF',
1000 REM "Beginning Customer"
1005 PRINT 'CF'
1010 IF LEN(K0$)=0 THEN DIM K0$(P[0])
1020 LET V0$="M",V1$="CE",V2$=K0$(1,P[0]),V3$="000000",V4$="Beginning Customer Number (<F1>=First/<F3>=Lookup)",V0=6,V1=40,V2=3,I0=0; REM "WA: #221
1030 GOSUB 7000
1040 IF V3=4 THEN GOTO 9900
1045 IF V3=3 THEN CALL "SYC.LC",V$
1050 IF V3=1 OR V$="" OR V$=J0$(1,LEN(V$)) THEN PRINT @(V1,V2),"First",'CL',; LET K0$=""; GOTO 1090
1060 FIND (ARM01_DEV,KEY=N0$+V$,DOM=1000)IOL=ARM01A
1070 PRINT @(V1,V2),FNF$(V$(1,P[0]),"000000")," ",B1$(1,30),'CL',
1080 LET K0$=V$
1090 GOTO 3900
1100 REM "Ending Customer"
1110 IF LEN(K1$)=0 THEN DIM K1$(P[0])
1120 LET V0$="M",V1$="CE",V2$=K1$(1,P[0]),V3$="000000",V4$="Ending Customer Number (<F1>=Last/<F3>=Lookup)",V0=6,V1=40,V2=5; REM "WA: #221
1130 GOSUB 7000
1135 IF V$<>"" AND V$<K0$ THEN GOTO 1100
1140 IF V3=4 THEN GOTO 9900
1145 IF V3=3 THEN CALL "SYC.LC",V$
1150 IF V3=1 OR V$="" OR V$=J0$(1,LEN(V$)) THEN PRINT @(V1,V2),"Last",'CL',; LET K1$=""; GOTO 1190
1160 FIND (ARM01_DEV,KEY=N0$+V$,DOM=0850)IOL=ARM01A
1170 PRINT @(V1,V2),FNF$(V$(1,P[0]),"000000")," ",B1$(1,30),'CL',
1180 LET K1$=V$
1190 GOTO 3900
1200 REM "Include Comments?"
1210 LET V0$="Y",V1$="C",V2$="Y",V3$="",V0=1,V1=40,V2=7
1215 LET V4$="Include Comments on Listing (Y=Yes/N=No)?"
1220 GOSUB 7000
1230 IF V3=4 THEN GOTO 9900
1240 LET Y$=V$
1290 GOTO 3900
1300 REM "BEGINNING CUSTOMER TYPE
1310 LET V0$="S",V1$="C",V2$=X10$,V0=3,V1=40,V2=7,V4$="Enter A Customer Type Code To Print, <F1>=First, <F3>=Lookup"
1315 GOSUB 7000
1320 IF V3=3 THEN GOTO 1350
1325 IF V3=4 THEN GOTO 9900
1330 IF V3=2 THEN GOTO 3900
1335 IF V3=1 OR V$="" THEN PRINT @(V1,V2),'CL',"First",; LET X10$=""; GOTO 1390
1340 GOTO 1360
1350 LET V4=1,V5=10,V6=4,V7=3,V8=7,V9=20,V5$="L"
1355 CALL "SYC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
1360 LET X10$=V$
1365 IF LEN(X10$)<3 THEN LET X10$=X10$+"   "
1370 LET X10$=X10$(1,3)
1375 FIND (10,KEY=N0$+"L"+X10$,DOM=1300)CTYPE$
1380 PRINT @(V1,V2),X10$,"  ",CTYPE$(7,20)
1390 GOTO 3900
1400 REM "ENDING CUSTOMER TYPE
1410 LET V0$="S",V1$="C",V2$=X11$,V0=3,V1=40,V2=9,V4$="Enter A Customer Type Code To Print, <F1>=Last,<F3>=Lookup"
1415 GOSUB 7000
1420 IF V3=3 THEN GOTO 1450
1425 IF V3=4 THEN GOTO 9900
1430 IF V3=2 THEN GOTO 3900
1435 IF V3=1 OR V$="" THEN PRINT @(V1,V2),'CL',"Last",; LET X11$=""; GOTO 1490
1440 GOTO 1460
1450 LET V4=1,V5=10,V6=4,V7=3,V8=7,V9=20,V5$="L"
1455 CALL "SYC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
1460 LET X11$=V$
1465 IF LEN(X11$)<3 THEN LET X11$=X11$+"   "
1470 LET X11$=X11$(1,3)
1475 FIND (10,KEY=N0$+"L"+X11$,DOM=1400)CTYPE$
1480 PRINT @(V1,V2),X11$,"  ",CTYPE$(7,20)
1490 GOTO 3900
3900 REM "NEXT FIELD"
3905 IF V3=4 THEN GOTO 4000
3910 IF V3<>2 THEN GOTO 3940
3920 IF I0>0 THEN LET I0=I0-1
3930 GOTO 3950
3940 LET I0=I0+1
3950 IF ABS(I0)>1000 THEN GOTO 3990
3960 ON I0 GOTO 1000,1100,1300,1400,3990
4000 REM "OVERLAY"
4010 LET V0$="Y",V1$="CE",V2$="",V3$="",V4$="Is The Above Information Correct (Y/N)?",V0=1,V1=FNV(V4$),V2=22
4020 GOSUB 7000
4030 IF V$="Y" THEN GOTO 4100
4040 IF V$="N" THEN GOTO 1000
4050 IF V3=4 THEN GOTO 9900
4060 GOTO 4000
4100 REM "INIT FILE"
4130 LET O9=1,O9$="SYS.AA"
4190 RUN "TMC.NA"
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM "FUNCTIONS"
8060 DEF FNF$(Q$,Q1$)=STR(-NUM(Q$):Q1$)
8090 DEF FNV(Q$)=42+INT(LEN(Q$)/2)
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9210 SETERR 9000
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9800 REM " --- Display Parameter record error"
9810 LET LINE_ERR$=LST(PGM(TCB(5)))
9820 CALL "SYC.YA",LINE_ERR$,N2$,ERR
9900 RUN "SYS.AA"
9999 END
62000 REM " --- Set-up ADD+ON Environment"
62010 DIM PRM$[0]; CALL "ADC.01",PRM$[ALL],STATUS
62020 IF STATUS<>0 THEN EXITTO 9900
62030 LET FID=0,AP=1,AR=2,BM=3,DC=4,FA=5,GL=6,IV=7,MP=8,OP=9,PO=10,PR=11,SA=12,SH=13,SY=14,WO=15,TS=21,TB=22,DC=23,V2=24,EF=25; REM " ---- Module Id Numbers"
62040 DIM J$(80,"-"),J0$(40,"0"),J1$(80)
62050 LET INSTALL=0,KEYLEN=1,KEYMAX=2,KEYMASK=3,CPERIOD=4,CYEAR=5,DMASK=6,UMASK=7,RMASK=8,TWO=9,THREE=10,FOUR=11,EMASK=12,TOPCODE=1,TDATE=2,TMENU=3,TPRINTER=4,TSECURE=5,TFIRM=6,TPMODE=7,TPROG=8,TPOPTS=9,TFNAME=10,TPNAME=11,TLDATE=12
62090 RETURN 
65000 END
