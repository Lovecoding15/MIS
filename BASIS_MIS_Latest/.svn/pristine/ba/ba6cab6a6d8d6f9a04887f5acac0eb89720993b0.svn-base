0010 REM "GLP - Chart of Accounts Breaks"
0020 REM "Program GLP.AC"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM 
0085 SETESC 9000
0090 SETERR 9000
0200 REM " --- IOLIST's"
0210 GLS01B: IOLIST B0$,B1$(1)
0220 GLM10A: IOLIST C0$,C1$(1),C2$(1)
0500 REM " --- Initializations"
0510 DIM J0$(40,"0")
0550 LET L0=6,L9=21,A1=LEN(A1$),A5=LEN(A5$),P0=NUM(A2$(7,2))
0560 CALL "GLC.RG",GLM10_DEV,N0$,BREAK$,DESC$
0590 LET B0$=N0$+N2$+"01"
0700 REM " --- Background"
0710 PRINT @(0,3),'CE',
0720 CALL "SYC.WC",1,0,80,0,0,4,0
0750 PRINT 'SB',@(13,3),"Retained Earnings Account:",@(1,5),"Account Break",@(18),"Description",@(41),"Account Break",@(58),"Description",'SF',
1200 REM " --- Retrieve Record"
1210 FIND (SYS01_DEV,KEY=B0$,DOM=1300)IOL=GLS01B
1300 REM " --- Display"
1310 GOSUB 5000
1390 GOTO 4000
2000 REM " --- Retained Earnings Account"
2010 LET V4$="Enter Retained Earnings Account Number (<F3>=Lookup)"
2020 LET V0$="M",V1$="C",V2$=B1$(1,P0),V3$=A1$,V0=P8,V1=40,V2=3,I0=0
2030 GOSUB 7000
2040 ON V3 GOTO 2100,2000,2000,2050,3900
2050 CALL "SYC.LG",V$
2060 IF V$="" THEN GOTO 2000
2100 REM 
2110 LET B1$(1)=V$
2120 PRINT @(V1,V2),FNF$(B1$(1,P0),A5$),
2190 GOTO 3900
2200 REM " --- Breaks"
2210 LET X=INT((I0+1)/2),P1=(X-1)*P8+1,P2=(X-1)*P9+1,V1=1,V2=L0-1+X
2220 IF X>16 THEN LET V1=V1+40,V2=L0-1+(X-16)
2230 LET V4$="Enter G/L Chart of Accounts Break Number (<F1>=Delete/<F3>=Lookup)"
2240 LET V0$="M",V1$="C",V2$=BREAK$(P1,P0),V3$=A1$,V0=P8
2250 GOSUB 7000
2260 ON V3 GOTO 2500,2300,3900,2400,3900
2300 REM " --- <F1> Delete"
2310 LET BREAK$(1)=BREAK$(1,P1-1)+BREAK$(P1+P8)
2320 LET DESC$(1)=DESC$(1,P2-1)+DESC$(P2+P9)
2330 GOSUB 5000
2390 GOTO 2200
2400 REM " --- <F3> Lookup"
2410 CALL "SYC.LG",V$
2420 IF V$="" THEN GOTO 2200
2500 REM 
2510 IF V$=J0$(1,LEN(V$)) THEN LET V$=""
2520 LET BREAK$(P1,P8)=V$
2530 PRINT @(V1,V2),FNF$(BREAK$(P1,P0),A5$)
2590 GOTO 3900
2600 REM " --- Descriptions"
2610 LET X=INT(I0/2),P1=(X-1)*P8+1,P2=(X-1)*P9+1,V1=18,V2=L0-1+X
2620 IF X>16 THEN LET V1=V1+40,V2=L0-1+(X-16)
2630 LET V4$="Enter The Description For This Chart of Accounts Break"
2640 LET V0$="S",V1$="C",V2$=DESC$(P2,P9),V3$="",V0=P9
2650 GOSUB 7000
2660 ON V3 GOTO 2670,2600,3900,2600,3900
2670 LET DESC$(P2,P9)=V$
2680 PRINT @(V1,V2),DESC$(P2,P9)
2690 GOTO 3900
3900 REM " --- Next field"
3905 IF V3=4 THEN GOTO 3970
3910 IF V3<>2 THEN GOTO 3940
3920 IF I0>0 THEN LET I0=I0-1
3930 GOTO 3950
3940 LET I0=I0+1
3960 ON I0 GOTO 2000,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,2200,2600,3970
3970 GOSUB 6100
3980 GOSUB 5000
3990 LET I0=0
4000 REM " --- Correct?"
4010 LET V4$="Is The Above Information Correct (Y/N)?"
4020 LET V0$="Y",V1$="C",V2$="Y",V3$="",V0=1,V1=FNV(V4$),V2=22
4030 GOSUB 7000
4040 ON V3 GOTO 4050,4000,4000,4000,4400
4090 ON POS(V$="YN") GOTO 4000,4100,2000
4100 REM " --- Write"
4110 GOSUB 6100
4115 IF STATUS>0 THEN GOTO 4200
4120 WRITE (SYS01_DEV,KEY=B0$)IOL=GLS01B
4130 GOSUB WRITE_GLM10
4150 IF O0=2 THEN GOTO 4900
4190 GOTO 4400
4200 REM " --- Duplicate chart of accounts break entered"
4210 DIM MESSAGE$[1]
4220 LET MESSAGE$[0]="Chart Of Accounts Breaks May Not Be Duplicated (<Enter>=Continue)"
4240 CALL "SYC.XA",1,MESSAGE$[ALL],0,22,-1,V$,V3
4280 LET I0=STATUS*2-2
4290 GOTO 3900
4400 REM " --- Return to menu"
4410 LET O0=1
4490 RUN "GLP.AA"
4900 REM " --- Run Next Overlay"
4990 RUN "GLP.AD"
5000 REM " --- Display Record"
5010 LET ROW=L0-1,COLUMN=1
5020 PRINT 'CF',@(40,3),FNF$(B1$(1,P0),A5$),
5030 FOR X=1 TO P7
5040 LET P1=(X-1)*P8+1,P2=(X-1)*P9+1
5050 IF FNP$(BREAK$(P1,P8))="" THEN GOTO 5080
5055 LET ROW=ROW+1
5060 IF ROW>L9 THEN LET ROW=L0,COLUMN=COLUMN+40
5070 PRINT @(COLUMN,ROW),FNF$(BREAK$(P1,P0),A5$),@(COLUMN+17),DESC$(P2,P9),
5080 NEXT X
5090 RETURN 
6100 REM " --- Sort by Account Number"
6110 FOR X=0 TO P7-1
6120 LET P1=X*P8+1,P2=X*P9+1,X1=POS(BREAK$(P1,P8)>BREAK$(P1),P8)
6130 IF X1=0 THEN GOTO 6190
6140 LET P3=X*P8+X1,P4=X*P9+INT(X1/P8)*P9+1
6150 LET X$=BREAK$(P1,P8),BREAK$(P1,P8)=BREAK$(P3,P8),BREAK$(P3,P8)=X$
6160 LET X$=DESC$(P2,P9),DESC$(P2,P9)=DESC$(P4,P9),DESC$(P4,P9)=X$
6180 GOTO 6120
6190 NEXT X
6200 REM 
6210 LET X1=POS(" "<>BREAK$),STATUS=0
6220 IF X1=0 THEN GOTO 6250
6230 LET BREAK$=BREAK$(X1)+BREAK$(1,X1-1)
6240 LET DESC$=DESC$(INT(X1/P8)*P9+1)+DESC$(1,INT(X1/P8)*P9)
6250 FOR X=1 TO LEN(BREAK$) STEP P8
6260 IF FNP$(BREAK$(X,P8))="" OR STATUS>0 THEN GOTO 6280
6265 IF POS(BREAK$(X,P8)=BREAK$(X+P8),P8)=0 THEN GOTO 6280
6270 LET STATUS=INT(X/P8)+1
6280 NEXT X
6290 RETURN 
6300 REM " --- Write to GLM-10
6305 WRITE_GLM10: 
6310 LET SEQNUM=0
6315 DIM C0$(5),C1$(10),C2$(20)
6320 FOR CNT=0 TO (LEN(BREAK$)/10)-1
6330 LET C0$(1)=N0$+STR(SEQNUM:"000")
6340 LET C1$(1)=BREAK$(CNT*10+1,10)
6350 LET C2$(1)=DESC$(CNT*20+1,20)
6360 WRITE (GLM10_DEV,KEY=C0$)IOL=GLM10A
6370 LET SEQNUM=SEQNUM+1
6380 NEXT CNT
6390 RETURN 
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM " --- Functions
8080 DEF FNP$(Q$)=CVS(Q$,2)
8090 DEF FNV(Q$)=42+INT(LEN(Q$)/2)
8200 REM " --- FNF$ AlphaNumeric Masking Function"
8210 DEF FNF$(Q1$,Q2$)
8220 IF Q2$="" THEN LET Q2$=FILL(LEN(Q1$),"0")
8230 RETURN STR(-NUM(Q1$,ERR=ALPHA_FNF):Q2$,ERR=ALPHA_FNF)
8240 ALPHA_FNF: 
8245 LET Q=1,Q0=0
8250 WHILE LEN(Q2$(Q))
8255 IF POS(Q2$(Q,1)="-()") THEN LET Q0=Q0+1 ELSE LET Q2$(Q,1)="X"
8260 LET Q=Q+1
8265 WEND
8270 IF LEN(Q1$)>LEN(Q2$)-Q0 THEN LET Q1$=Q1$(1,LEN(Q2$)-Q0)
8280 RETURN STR(Q1$:Q2$)
8290 FNEND
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 RUN "SYS.AA"
9999 END
