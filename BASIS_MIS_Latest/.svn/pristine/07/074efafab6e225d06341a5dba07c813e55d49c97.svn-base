0010 REM "SAC - Retrieve Sales Analysis Control Parameters
0020 REM "Program SAC.PA"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM 
0041 REM "ACTION        : Specifies which sales analysis to perform (Input)
0042 REM "                 1 = SAM-01  Customer      Product    Item
0043 REM "                 2 = SAM-02  Territory     Product    Item
0044 REM "                 3 = SAM-03  Salesperson   Product    Item
0045 REM "                 4 = SAM-04  Cust Type     Product    Item
0046 REM "                 5 = SAM-05  Customer      Ship-To    Item
0047 REM "                 6 = SAM-06  SIC           Product    Item
0048 REM "                 7 = SAM-07  Product       Item
0049 REM "                 8 = SAM-08  Warehouse     Product    Item
0050 REM "                 9 = SAM-09  Vendor        Product    Item
0051 REM "                10 = SAM-10  Dist Code     Product    Item
0052 REM "                11 = SAM-11  Product       Non-Stock
0053 REM "                12 = SAM-12  Territory     Customer   Product
0054 REM "               >20 = use cross reference file
0055 REM "SYS01_DEV     : SYS-01 channel (Input)
0056 REM "N0$           : Firm ID (Input)
0057 REM "SEGMENTS      : Number of key segments to use (Returned)
0058 REM "LEVELS$[n]    : Character designation of detail levels (Returned)
0059 REM "LITERALS$[n]  : Screen literals to display (Returnd)
0060 REM "TYPES$[n]     : V0$ field types (Returned)
0061 REM "IMASKS$[n]    : V3$ field input masks (Returned)
0062 REM "OMASKS$[n]    : Output display masks (Returned)
0063 REM "PROMPTS$[n]   : V4$ field prompts to display (Returned)
0064 REM "INLEN[n]      : Number of characters in input field (Returned)
0065 REM "FLDLEN[n]     : Length of key segment (Returned)
0066 REM "DESCCHAN[n]   : Channel of file to obtain description (Returned)
0067 REM "DESCREC$[n]   : ID of record to obtain description (Returned)
0068 REM "DESCSTR[n]    : IOLIST string containing description (Returned)
0069 REM "DESCPOS[n]    : Start position of description in DESCSTR (Returned)
0070 REM "DESCLEN[n]    : Length of description in DESCSTR (Returned)
0071 REM "SA_CHANNELS[n]: Channels of Sales Analysis files (Returned)
0072 REM "                [1]=SAM-xx file   [2]=SAM-xx cross reference file
0073 REM "KEYLEN        : Key length of SAM-xx record (Returned)
0074 REM "XREFS[n]      : Segment position in cross reference file (Returned)
0075 REM "FY$           : Current Sales Analysis fiscal year (Returned)
0076 REM "PERIODS       : Number of fiscal periods (Returned)
0077 REM "PERIODS$[x]   : Abbreviated period names (Returned)
0078 REM "IV_MASKS$[y]  : Inventory parameter masks (Returned)
0079 REM "                [1] = Amount   [2] = Unit   [3] = Cost
0080 REM "IV_DESC[z]    : Inventory item description parameters (Returned)
0081 REM "                [0]        = Item number length
0082 REM "                [1] to [3] = Description segment lengths
0083 REM "IVM14_DEV     : IVM-14 channel (Returned)
0084 REM "STATUS        : Status Code (0 = No Errors) (Returned)
0085 REM 
0086 SETESC 9000
0088 SETERR 9000
0090 ENTER ACTION,SYS01_DEV,N0$,SEGMENTS,LEVELS$[ALL],LITERALS$[ALL],TYPES$[ALL],IMASKS$[ALL],OMASKS$[ALL],PROMPTS$[ALL],INLEN[ALL],FLDLEN[ALL],DESCCHAN[ALL],DESCREC$[ALL],DESCSTR[ALL],DESCPOS[ALL],DESCLEN[ALL],SA_CHANNELS[ALL],KEYLEN,XREFS[ALL],FY$,PERIODS,PERIODS$[ALL],IV_MASKS$[ALL],IV_DESC[ALL],IVM14_DEV,STATUS
0100 REM " --- Open/Lock Files"
0110 LET FILES=7
0120 DIM FILES$[FILES],OPTIONS$[FILES],CHANNELS[FILES]
0130 LET FILES$[7]="IVM-14"
0200 REM " --- IOLIST's"
0210 SAS01A: IOLIST SAP0$,SAP1$(1),SAP2$(1)
0220 APS01A: IOLIST APP0$,APP1$,APP2$,APP3$,APP4$,APM0$,APM1$,APM2$,APM3$
0230 ARS01A: IOLIST ARP0$,ARP1$,ARP2$(1),ARP3$,ARP4$(1),ARM0$,ARM1$,ARM2$,ARM3$
0240 GLS01A: IOLIST GLP0$,GLP1$,GLP2$(1),GLP3$(1)
0250 IVS01A: IOLIST IVP0$,IVP1$,IVP2$(1),IVP3$,IVP4$,IVM0$,IVM1$,IVM2$,IVM3$
0400 REM " --- Parameters"
0410 DIM SAP1$(11),SAP2$(11),ARP2$(6),ARP4$(4),GLP2$(10),GLP3$(13*25),IVP2$(53)
0430 FIND (SYS01_DEV,KEY=N0$+"SA00",DOM=9800)IOL=SAS01A
0440 FIND (SYS01_DEV,KEY=N0$+"AR00",DOM=9800)IOL=ARS01A
0450 FIND (SYS01_DEV,KEY=N0$+"GL00",DOM=9800)IOL=GLS01A
0460 FIND (SYS01_DEV,KEY=N0$+"IV00",DOM=9800)IOL=IVS01A
0480 IF ACTION=9 THEN FIND (SYS01_DEV,KEY=N0$+"AP00",DOM=9800)IOL=APS01A
0500 REM " --- Initializations"
0510 LET XREFS[1]=1,XREFS[2]=2,XREFS[3]=3,XREFS[4]=4
0520 LET FY$=ARP4$(3,2),PERIODS=NUM(GLP2$(1,2))
0530 FOR X=1 TO PERIODS
0540 LET PERIODS$[X]=GLP3$(235+3*(X-1),3)
0550 NEXT X
0560 LET IV_MASKS$[1]=IVM1$,IV_MASKS$[2]=IVM2$,IV_MASKS$[3]=IVM3$
0570 LET IV_DESC[0]=NUM(IVP2$(1,2)),IV_DESC[1]=NUM(IVP2$(9,2)),IV_DESC[2]=NUM(IVP2$(11,2)),IV_DESC[3]=NUM(IVP2$(13,2))
1000 REM " --- Which Sales Analysis?"
1020 ON MOD(ACTION,20) GOTO 9800,1100,1200,1300,1400,1500,1600,1700,1800,1900,2000,2100,2200,9800
1100 REM " --- (Action = 1 & 21) Customer/Product/Item"
1105 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1110 LET LEVELS$[1]="C",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1115 LET LITERALS$[1]="Customer",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
1120 LET TYPES$[1]="M",TYPES$[2]="S",TYPES$[3]="S"
1124 LET IMASKS$[1]=ARP1$,IMASKS$[2]="",IMASKS$[3]=""
1126 LET OMASKS$[1]=ARM0$,OMASKS$[2]="",OMASKS$[3]=""
1130 FOR X=1 TO SEGMENTS
1135 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1140 NEXT X
1145 LET INLEN[1]=NUM(ARP2$(1,2)),INLEN[2]=3,INLEN[3]=IV_DESC[0]
1150 LET FLDLEN[1]=6,FLDLEN[2]=3,FLDLEN[3]=20
1155 LET FILES$[1]="ARM-01",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]
1160 LET DESCREC$[1]="",DESCREC$[2]="A",DESCREC$[3]=""
1165 LET DESCSTR[1]=1,DESCSTR[2]=0,DESCSTR[3]=1
1170 LET DESCPOS[1]=1,DESCPOS[2]=7,DESCPOS[3]=1
1175 LET DESCLEN[1]=30,DESCLEN[2]=20,DESCLEN[3]=60
1180 LET FILES$[5]="SAM-01",FILES$[6]="SAM-21"; REM "Files for SA_CHANNELS[1 & 2]
1185 LET KEYLEN=33
1190 LET XREFS[1]=3,XREFS[2]=1,XREFS[3]=2; REM "Cross references to SAM-21
1195 GOTO 4000
1200 REM " --- (Action = 2) Territory/Product/Item
1205 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1210 LET LEVELS$[1]="T",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1215 LET LITERALS$[1]="Territory",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
1220 LET TYPES$[1]="S",TYPES$[2]="S",TYPES$[3]="S"
1224 LET IMASKS$[1]="",IMASKS$[2]="",IMASKS$[3]=""
1226 LET OMASKS$[1]="",OMASKS$[2]="",OMASKS$[3]=""
1230 FOR X=1 TO SEGMENTS
1235 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1240 NEXT X
1245 LET INLEN[1]=3,INLEN[2]=3,INLEN[3]=IV_DESC[0]
1250 LET FLDLEN[1]=3,FLDLEN[2]=3,FLDLEN[3]=20
1255 LET FILES$[1]="ARM-10",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]
1260 LET DESCREC$[1]="H",DESCREC$[2]="A",DESCREC$[3]=""
1265 LET DESCSTR[1]=0,DESCSTR[2]=0,DESCSTR[3]=1
1270 LET DESCPOS[1]=7,DESCPOS[2]=7,DESCPOS[3]=1
1275 LET DESCLEN[1]=20,DESCLEN[2]=20,DESCLEN[3]=60
1280 LET FILES$[5]="SAM-02",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1285 LET KEYLEN=30
1290 GOTO 4000
1300 REM " --- (Action = 3) Salesperson/Product/Item
1305 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1310 LET LEVELS$[1]="S",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1315 LET LITERALS$[1]="Salesperson",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
1320 LET TYPES$[1]="S",TYPES$[2]="S",TYPES$[3]="S"
1324 LET IMASKS$[1]="",IMASKS$[2]="",IMASKS$[3]=""
1326 LET OMASKS$[1]="",OMASKS$[2]="",OMASKS$[3]=""
1330 FOR X=1 TO SEGMENTS
1335 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1340 NEXT X
1345 LET INLEN[1]=3,INLEN[2]=3,INLEN[3]=IV_DESC[0]
1350 LET FLDLEN[1]=3,FLDLEN[2]=3,FLDLEN[3]=20
1355 LET FILES$[1]="ARM-10",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]
1360 LET DESCREC$[1]="F",DESCREC$[2]="A",DESCREC$[3]=""
1365 LET DESCSTR[1]=0,DESCSTR[2]=0,DESCSTR[3]=1
1370 LET DESCPOS[1]=7,DESCPOS[2]=7,DESCPOS[3]=1
1375 LET DESCLEN[1]=20,DESCLEN[2]=20,DESCLEN[3]=60
1380 LET FILES$[5]="SAM-03",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1385 LET KEYLEN=30
1390 GOTO 4000
1400 REM " --- (Action = 4) Customer Type/Product/Item
1405 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1410 LET LEVELS$[1]="C",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1415 LET LITERALS$[1]="Customer Type",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
1420 LET TYPES$[1]="S",TYPES$[2]="S",TYPES$[3]="S"
1424 LET IMASKS$[1]="",IMASKS$[2]="",IMASKS$[3]=""
1426 LET OMASKS$[1]="",OMASKS$[2]="",OMASKS$[3]=""
1430 FOR X=1 TO SEGMENTS
1435 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1440 NEXT X
1445 LET INLEN[1]=3,INLEN[2]=3,INLEN[3]=IV_DESC[0]
1450 LET FLDLEN[1]=3,FLDLEN[2]=3,FLDLEN[3]=20
1455 LET FILES$[1]="ARM-10",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]
1460 LET DESCREC$[1]="L",DESCREC$[2]="A",DESCREC$[3]=""
1465 LET DESCSTR[1]=0,DESCSTR[2]=0,DESCSTR[3]=1
1470 LET DESCPOS[1]=7,DESCPOS[2]=7,DESCPOS[3]=1
1475 LET DESCLEN[1]=20,DESCLEN[2]=20,DESCLEN[3]=60
1480 LET FILES$[5]="SAM-04",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1485 LET KEYLEN=30
1490 GOTO 4000
1500 REM " --- (Action = 5) Customer/Ship-to/Item"
1505 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1510 LET LEVELS$[1]="C",LEVELS$[2]="S",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1515 LET LITERALS$[1]="Customer",LITERALS$[2]="Customer Ship-To",LITERALS$[3]="Item"
1520 LET TYPES$[1]="M",TYPES$[2]="Z",TYPES$[3]="S"
1524 LET IMASKS$[1]=ARP1$,IMASKS$[2]="",IMASKS$[3]=""
1526 LET OMASKS$[1]=ARM0$,OMASKS$[2]="",OMASKS$[3]=""
1530 FOR X=1 TO SEGMENTS
1535 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1540 NEXT X
1545 LET INLEN[1]=NUM(ARP2$(1,2)),INLEN[2]=6,INLEN[3]=IV_DESC[0]
1550 LET FLDLEN[1]=6,FLDLEN[2]=6,FLDLEN[3]=20
1555 LET FILES$[1]="ARM-01",FILES$[2]="ARM-03",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]
1560 LET DESCREC$[1]="",DESCREC$[2]="",DESCREC$[3]=""
1565 LET DESCSTR[1]=1,DESCSTR[2]=1,DESCSTR[3]=1
1570 LET DESCPOS[1]=1,DESCPOS[2]=1,DESCPOS[3]=1
1575 LET DESCLEN[1]=30,DESCLEN[2]=30,DESCLEN[3]=60
1580 LET FILES$[5]="SAM-05",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1585 LET KEYLEN=36
1590 GOTO 4000
1600 REM " --- (Action = 6) SIC/Product/Item"
1605 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1610 LET LEVELS$[1]="C",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1615 LET LITERALS$[1]="SIC",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
1620 LET TYPES$[1]="S",TYPES$[2]="S",TYPES$[3]="S"
1624 LET IMASKS$[1]="",IMASKS$[2]="",IMASKS$[3]=""
1626 LET OMASKS$[1]="",OMASKS$[2]="",OMASKS$[3]=""
1630 FOR X=1 TO SEGMENTS
1635 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1640 NEXT X
1645 LET INLEN[1]=8,INLEN[2]=3,INLEN[3]=IV_DESC[0]
1650 LET FLDLEN[1]=8,FLDLEN[2]=3,FLDLEN[3]=20
1655 LET FILES$[1]="",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]
1660 LET DESCREC$[1]="",DESCREC$[2]="A",DESCREC$[3]=""
1665 LET DESCSTR[1]=0,DESCSTR[2]=0,DESCSTR[3]=1
1670 LET DESCPOS[1]=8,DESCPOS[2]=7,DESCPOS[3]=1
1675 LET DESCLEN[1]=20,DESCLEN[2]=20,DESCLEN[3]=60
1680 LET FILES$[5]="SAM-06",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1685 LET KEYLEN=35
1690 GOTO 4000
1700 REM " --- (Action = 7) Product/Item"
1705 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1710 LET LEVELS$[1]="P",LEVELS$[2]="I",LEVELS$[3]="",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1715 LET LITERALS$[1]="Product Type",LITERALS$[2]="Item"
1720 LET TYPES$[1]="S",TYPES$[2]="S"
1724 LET IMASKS$[1]="",IMASKS$[2]=""
1726 LET OMASKS$[1]="",OMASKS$[2]=""
1730 FOR X=1 TO SEGMENTS
1735 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1740 NEXT X
1745 LET INLEN[1]=3,INLEN[2]=IV_DESC[0]
1750 LET FLDLEN[1]=3,FLDLEN[2]=20
1755 LET FILES$[1]="IVM-10",FILES$[2]="IVM-01",FILES$[3]=""; REM "Files for DESCCHAN[1, 2 & 3]
1760 LET DESCREC$[1]="A",DESCREC$[2]=""
1765 LET DESCSTR[1]=0,DESCSTR[2]=1
1770 LET DESCPOS[1]=7,DESCPOS[2]=1
1775 LET DESCLEN[1]=20,DESCLEN[2]=60
1780 LET FILES$[5]="SAM-07",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1785 LET KEYLEN=27
1790 GOTO 4000
1800 REM " --- (Action = 8) Warehouse/Product/Item"
1805 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1810 LET LEVELS$[1]="W",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1815 LET LITERALS$[1]="Warehouse",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
1820 LET TYPES$[1]="S",TYPES$[2]="S",TYPES$[3]="S"
1824 LET IMASKS$[1]="",IMASKS$[2]="",IMASKS$[3]=""
1826 LET OMASKS$[1]="",OMASKS$[2]="",OMASKS$[3]=""
1830 FOR X=1 TO SEGMENTS
1835 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1840 NEXT X
1845 LET INLEN[1]=2,INLEN[2]=3,INLEN[3]=IV_DESC[0]
1850 LET FLDLEN[1]=2,FLDLEN[2]=3,FLDLEN[3]=20
1855 LET FILES$[1]="IVM-10",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]  
1860 LET DESCREC$[1]="C",DESCREC$[2]="A",DESCREC$[3]=""
1865 LET DESCSTR[1]=0,DESCSTR[2]=0,DESCSTR[3]=1
1870 LET DESCPOS[1]=6,DESCPOS[2]=7,DESCPOS[3]=1
1875 LET DESCLEN[1]=24,DESCLEN[2]=20,DESCLEN[3]=60
1880 LET FILES$[5]="SAM-08",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1885 LET KEYLEN=29
1890 GOTO 4000
1900 REM " --- (Action = 9) Vendor/Product/Item"
1905 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
1910 LET LEVELS$[1]="V",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
1915 LET LITERALS$[1]="Vendor",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
1920 LET TYPES$[1]="M",TYPES$[2]="S",TYPES$[3]="S"
1924 LET IMASKS$[1]=APP1$,IMASKS$[2]="",IMASKS$[3]=""
1926 LET OMASKS$[1]=APM0$,OMASKS$[2]="",OMASKS$[3]=""
1930 FOR X=1 TO SEGMENTS
1935 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
1940 NEXT X
1945 LET INLEN[1]=NUM(APP2$(1,2)),INLEN[2]=3,INLEN[3]=IV_DESC[0]
1950 LET FLDLEN[1]=6,FLDLEN[2]=3,FLDLEN[3]=20
1955 LET FILES$[1]="APM-01",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]
1960 LET DESCREC$[1]="",DESCREC$[2]="A",DESCREC$[3]=""
1965 LET DESCSTR[1]=1,DESCSTR[2]=0,DESCSTR[3]=1
1970 LET DESCPOS[1]=1,DESCPOS[2]=7,DESCPOS[3]=1
1975 LET DESCLEN[1]=30,DESCLEN[2]=20,DESCLEN[3]=60
1980 LET FILES$[5]="SAM-09",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
1985 LET KEYLEN=33
1990 GOTO 4000
2000 REM " --- (Action = 10) Dist Code/Product/Item"
2005 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
2010 LET LEVELS$[1]="D",LEVELS$[2]="P",LEVELS$[3]="I",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
2015 LET LITERALS$[1]="Distribution Code",LITERALS$[2]="Product Type",LITERALS$[3]="Item"
2020 LET TYPES$[1]="S",TYPES$[2]="S",TYPES$[3]="S"
2024 LET IMASKS$[1]="",IMASKS$[2]="",IMASKS$[3]=""
2026 LET OMASKS$[1]="",OMASKS$[2]="",OMASKS$[3]=""
2030 FOR X=1 TO SEGMENTS
2035 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
2040 NEXT X
2045 LET INLEN[1]=2,INLEN[2]=3,INLEN[3]=IV_DESC[0]
2050 LET FLDLEN[1]=2,FLDLEN[2]=3,FLDLEN[3]=20
2055 LET FILES$[1]="ARM-10",FILES$[2]="IVM-10",FILES$[3]="IVM-01"; REM "Files for DESCCHAN[1, 2 & 3]  
2060 LET DESCREC$[1]="D",DESCREC$[2]="A",DESCREC$[3]=""
2065 LET DESCSTR[1]=0,DESCSTR[2]=0,DESCSTR[3]=1
2070 LET DESCPOS[1]=6,DESCPOS[2]=7,DESCPOS[3]=1
2075 LET DESCLEN[1]=20,DESCLEN[2]=20,DESCLEN[3]=60
2080 LET FILES$[5]="SAM-10",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
2085 LET KEYLEN=29
2090 GOTO 4000
2100 REM " --- (Action = 11) Product/Non-stock
2105 IF SAP1$(MOD(ACTION,20),1)<>"Y" THEN GOTO 4500
2110 LET LEVELS$[1]="P",LEVELS$[2]="N",LEVELS$[3]="",SEGMENTS=POS(SAP2$(MOD(ACTION,20),1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3])
2115 LET LITERALS$[1]="Product Type",LITERALS$[2]="Non-Stock Item"
2120 LET TYPES$[1]="S",TYPES$[2]="S"
2124 LET IMASKS$[1]="",IMASKS$[2]=""
2126 LET OMASKS$[1]="",OMASKS$[2]=""
2130 FOR X=1 TO SEGMENTS
2135 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
2140 NEXT X
2145 LET INLEN[1]=3,INLEN[2]=40
2150 LET FLDLEN[1]=3,FLDLEN[2]=40
2155 LET FILES$[1]="IVM-10",FILES$[2]="",FILES$[3]=""; REM "Files for DESCCHAN[1, 2 & 3]
2160 LET DESCREC$[1]="A",DESCREC$[2]=""
2165 LET DESCSTR[1]=0,DESCSTR[2]=0
2170 LET DESCPOS[1]=7,DESCPOS[2]=0
2175 LET DESCLEN[1]=20,DESCLEN[2]=0
2180 LET FILES$[5]="SAM-11",FILES$[6]=""; REM "Files for SA_CHANNELS[1 & 2]
2185 LET KEYLEN=47
2190 GOTO 4000
2200 REM " --- (Action = 12) Territory/Customer/Product/Item"
2205 IF SAP1$(1,1)<>"Y" THEN GOTO 4500
2210 LET LEVELS$[1]="T",LEVELS$[2]="C",LEVELS$[3]="P",LEVELS$[4]="I",SEGMENTS=POS(SAP2$(1,1)=LEVELS$[1]+LEVELS$[2]+LEVELS$[3]+LEVELS$[4])
2215 LET LITERALS$[1]="Territory",LITERALS$[2]="Customer",LITERALS$[3]="Product Type",LITERALS$[4]="Item"
2220 LET TYPES$[1]="S",TYPES$[2]="M",TYPES$[3]="S",TYPES$[4]="S"
2224 LET IMASKS$[1]="",IMASKS$[2]=ARP1$,IMASKS$[3]="",IMASKS$[4]=""
2226 LET OMASKS$[1]="",OMASKS$[2]=ARM0$,OMASKS$[3]="",OMASKS$[4]=""
2230 FOR X=1 TO SEGMENTS
2235 LET PROMPTS$[X]="Enter Valid "+LITERALS$[X]
2240 NEXT X
2245 LET INLEN[1]=3,INLEN[2]=NUM(ARP2$(1,2)),INLEN[3]=3,INLEN[4]=IV_DESC[0]
2250 LET FLDLEN[1]=3,FLDLEN[2]=6,FLDLEN[3]=3,FLDLEN[4]=20
2255 LET FILES$[1]="ARM-10",FILES$[2]="ARM-01",FILES$[3]="IVM-10",FILES$[4]="IVM-01"; REM "Files for DESCCHAN[1, 2, 3 & 4]
2260 LET DESCREC$[1]="H",DESCREC$[2]="",DESCREC$[3]="A",DESCREC$[4]=""
2265 LET DESCSTR[1]=0,DESCSTR[2]=1,DESCSTR[3]=0,DESCSTR[4]=1
2270 LET DESCPOS[1]=7,DESCPOS[2]=1,DESCPOS[3]=7,DESCPOS[4]=1
2275 LET DESCLEN[1]=20,DESCLEN[2]=30,DESCLEN[3]=20,DESCLEN[4]=60
2280 LET FILES$[5]="SAM-12",FILES$[6]="SAM-01"; REM "Files for SA_CHANNELS[1 & 2]
2285 LET KEYLEN=36
2290 LET XREFS[1]=4,XREFS[2]=1,XREFS[3]=2,XREFS[4]=3; REM "Cross references to SAM-01
2295 GOTO 4000
4000 REM " --- Open Sales Analysis File(s)"
4010 CALL "SYC.DA",1,1,FILES,FILES$[ALL],OPTIONS$[ALL],CHANNELS[ALL],BATCH,STATUS
4020 IF STATUS THEN GOTO 9800
4030 LET DESCCHAN[1]=CHANNELS[1],DESCCHAN[2]=CHANNELS[2],DESCCHAN[3]=CHANNELS[3],DESCCHAN[4]=CHANNELS[4]
4040 LET SA_CHANNELS[1]=CHANNELS[5],SA_CHANNELS[2]=CHANNELS[6]
4050 LET IVM14_DEV=CHANNELS[7]
4100 REM " --- All Done"
4120 GOTO 9900
4500 REM " --- Selected Sales Analysis Not Available"
4510 LET NUMBER=1
4520 DIM MESSAGE$[NUMBER]
4530 LET MESSAGE$[0]="This Sales Analysis is currently not available."
4540 LET MESSAGE$[1]="           <Enter> = Continue"
4550 CALL "SYC.XA",3,MESSAGE$[ALL],NUMBER,-1,-1,V$,V3
4590 GOTO 9800
8000 REM " --- Functions"
8070 DEF FNP$(Q$)=CVS(Q$,2)
8080 DEF FNV(Q$)=42+INT(LEN(Q$)/2)
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9800 REM " --- Return STATUS = ERR"
9810 LET STATUS=ERR
9820 IF STATUS=0 THEN LET STATUS=999
9900 REM " --- Return to Calling Program"
9950 EXIT 
9999 END
