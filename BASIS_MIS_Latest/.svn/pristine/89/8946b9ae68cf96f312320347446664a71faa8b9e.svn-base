0010 REM "ARP - A/R Parameter Maintenance"
0020 REM "Program ARP.AB"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM 
0080 SETERR 9000
0090 SETESC 9000
0200 REM " --- IOLIST's"
0210 ARS01A: IOLIST A0$,A1$,A2$(1),A3$(1),A4$(1),M0$,M1$,M2$,M3$
0500 REM " --- Initializations"
0510 DIM A2$(6),A3$(114),A4$(4)
0590 LET A0$=N0$+N2$+"00",A2$(3,2)=STR(P8:"00"),A3$(1,3)="NNN"
0700 REM " --- Background"
0720 PRINT 'SB',@(25,4),"Customer Mask:",@(18,6),"Zip/Postal Code Size:",@(14,7),"Distribute Sales By Item:",@(24,8),"Current Period:",@(26,9),"Current Year:",@(27,11),"Amount Mask:",@(29,12),"Unit Mask:",@(29,13),"Rate Mask:",@(12,15),"Automatic Customer Numbers:",@(29,16),"Labels Up:",@(26,17),"Label Length:",@(27,18),"Label Width:",@(19,19),"Bank Reconciliation:",'SF',
1200 REM " --- Retrieve record"
1210 FIND (SYS01_DEV,KEY=A0$,DOM=1400)IOL=ARS01A
1240 LET P0=NUM(A2$(1,2))
1300 REM " --- Display"
1320 GOSUB 5000
1390 GOTO 4000
1400 REM " --- New record"
1410 DIM X$(20,"Y"),A3$(114),A1$(P8,"#")
1430 LET A3$(1,20)=X$,A3$(4,1)="9",A3$(5,6)="010636",A3$(11,4)="NNNN"
1440 LET A4$=G0$(3),M1$="###,###,##0.00-",M2$="###,##0-",M3$="##,##0.00-"
1450 IF AP$="Y" AND BR$="Y" AND GL$="Y" THEN LET A3$(14,1)="Y"
1490 GOSUB 5000
2000 REM " --- Customer Mask"
2010 LET V0$="S",V1$="RC",V2$=A1$,V3$="",V0=10,V1=40,V2=4,I0=0
2020 LET V4$="Enter Up To "+STR(P8)+" "+$22$+"#"+$22$+" Characters (Optionally) Separated By Another Character"
2030 GOSUB 7000
2035 ON V3 GOTO 2040,2000,2000,2000,3900
2040 GOSUB 6000
2050 IF V$="" THEN GOTO 2020
2060 LET A1$=V$
2070 GOSUB 6200
2075 IF P0>P8 THEN GOTO 2000
2080 LET A2$(1,2)=STR(P0:"00")
2090 GOTO 3900
2300 REM " --- Zip/Postal Code"
2310 LET V0$="Z",V1$="RC",V2$=A3$(4,1),V3$="59",V0=1,V1=40,V2=6
2320 LET V4$="Enter The Length Of The Zip/Postal Codes To Be Used (5 or 9)"
2330 GOSUB 7000
2340 ON V3 GOTO 2350,2300,3900,2300,3900
2350 LET A3$(4,1)=V$
2390 GOTO 3900
2400 REM " --- Current Period"
2410 LET V4$="Enter The Current A/R Period"
2420 LET V0$="Z",V1$="R",V2$=A4$(1,2),V3$="",V0=2,V1=40,V2=8
2430 GOSUB 7000
2440 ON V4 GOTO 2450,2400,3900,2400,3900
2450 IF V<1 OR V>G0 THEN GOTO 2400
2460 LET A4$(1,2)=V$
2490 GOTO 3900
2500 REM " --- Current Year"
2510 LET V4$="Enter The Current Fiscal Year"
2520 LET V0$="D",V1$="RY",V2$=A4$(3,2),V0=2,V1=40,V2=9
2530 GOSUB 7000
2540 ON V3 GOTO 2550,2500,3900,2500,3900
2550 LET A4$(3,2)=V$
2590 GOTO 3900
2600 REM " --- Amount Mask"
2610 LET V4$="Enter The Mask To Be Used For Extended Amounts"
2620 LET V0$="S",V1$="CR",V2$=M1$,V3$="",V0=15,V1=40,V2=11
2630 GOSUB 7000
2635 ON V3 GOTO 2640,2600,3900,2600,3900
2640 GOSUB 6100
2650 IF V$="" THEN GOTO 2600
2660 LET M1$=V$
2690 GOTO 3900
2700 REM " --- Unit Mask"
2710 LET V4$="Enter The Mask To Be Used For Units"
2720 LET V0$="S",V1$="CR",V2$=M2$,V0=12,V1=40,V2=12
2730 GOSUB 7000
2735 ON V3 GOTO 2740,2700,3900,2700,3900
2740 GOSUB 6100
2750 IF V$="" THEN GOTO 2700
2760 LET M2$=V$
2790 GOTO 3900
2800 REM " --- Rate Mask"
2810 LET V4$="Enter The Mask To Be Used For Costs"
2820 LET V0$="S",V1$="CR",V2$=M3$,V0=10,V1=40,V2=13
2830 GOSUB 7000
2835 ON V3 GOTO 2840,2800,3900,2800,3900
2840 GOSUB 6100
2850 IF V$="" THEN GOTO 2800
2860 LET M3$=V$
2890 GOTO 3900
2900 REM " --- Labels"
2910 LET X0=I0-9
2920 LET V0$="Z",V1$="C",V2$=A3$(5+X0*2,2),V3$="",V4$=""
2930 LET V0=2,V1=40,V2=16+X0
2940 GOSUB 7000
2950 ON V3 GOTO 2960,2900,3900,2900,3900
2960 LET A3$(5+X0*2,2)=V$
2990 GOTO 3900
3000 REM " --- Distribution by Item?"
3010 IF IV$<>"Y" THEN LET V$="N"; GOTO 3060
3020 LET V0$="Y",V1$="RC",V2$=A3$(11,1),V3$="",V0=1,V1=40,V2=7
3030 LET V4$="Y=GL Distribution By Inventory Item     N=GL Distribution By Customer"
3040 GOSUB 7000
3050 ON V3 GOTO 3060,3000,3900,3000,3900
3060 LET A3$(11,1)=V$
3090 GOTO 3900
3100 REM " --- Bank Reconciliation"
3110 LET V4$="Y=Use Bank Reconciliation for Deposits     N=Don't Use Bank Reconciliation"
3120 LET V0$="Y",V1$="RC",V2$=A3$(14,1),V3$="",V0=1,V1=40,V2=19,V$="N"
3125 IF AP$<>"Y" THEN GOTO 3170
3130 IF GL$<>"Y" THEN GOTO 3170
3135 IF BR$<>"Y" THEN GOTO 3170
3140 GOSUB 7000
3150 ON V3 GOTO 3160,3100,3900,3100,3900
3170 LET A3$(14,1)=V$
3180 PRINT @(V1,V2),A3$(14,1),
3190 GOTO 3900
3200 REM " --- Auto Customer Numbers?"
3210 LET V4$="Y=System Generates/Assigns New Numbers     N=User Assigns New Numbers"
3220 LET V0$="Y",V1$="C",V2$=A3$(13,1),V3$="",V0=1,V1=40,V2=15
3230 GOSUB 7000
3240 ON V3 GOTO 3250,3200,3900,3200,3900
3250 LET A3$(13,1)=V$
3290 GOTO 3900
3900 REM " --- Next Field"
3910 IF V3=4 THEN GOTO 4000
3920 IF V3<>2 THEN GOTO 3950
3930 IF I0>0 THEN LET I0=I0-1
3940 GOTO 3960
3950 LET I0=I0+1
3960 ON I0 GOTO 2000,2300,3000,2400,2500,2600,2700,2800,3200,2900,2900,2900,3100,3990
3990 LET I0=0
4000 REM " --- Correct?"
4010 LET V0$="S",V4$="Is The Above Information Correct (Y/N/Delete)?"
4020 LET V1$="KC",V2$="Y",V3$="",V0=6,V1=42+INT(LEN(V4$)/2),V2=22
4030 GOSUB 7000
4040 ON V3 GOTO 4050,4000,4000,4000,4900
4050 IF V$="DELETE" THEN GOTO 4200
4090 ON POS(V$="YN") GOTO 4000,4100,2000
4100 REM " --- Write record"
4110 WRITE (SYS01_DEV,KEY=A0$)IOL=ARS01A
4180 IF O0>0 THEN RUN "ARP.AC"
4190 GOTO 4900
4200 REM " --- Remove records"
4210 REMOVE (SYS01_DEV,KEY=A0$,DOM=4220)
4220 REMOVE (SYS01_DEV,KEY=N0$+N2$+"01",DOM=4230)
4230 REMOVE (SYS01_DEV,KEY=N0$+N2$+"02",DOM=4240)
4240 REMOVE (ARS10_DEV,KEY=N0$+"N",DOM=4250)
4290 GOTO 9900
4900 REM " --- Run menu overlay"
4990 RUN "ARP.AA"
5000 REM " --- Display"
5010 LET V$="N"
5020 IF IV$="Y" THEN LET V$=A3$(11,1)
5030 PRINT @(40,4),A1$,@(40,6),A3$(4,1),@(40,7),V$,@(40,8),A4$(1,2),@(40,9),FNYY21_YY$(A4$(3,2)),@(40,11),M1$,@(40,12),M2$,@(40,13),M3$,@(40,15),A3$(13,1),@(40,16),A3$(5,2),@(40,17),A3$(7,2),@(40,18),A3$(9,2),@(40,19),A3$(14,1),
5090 RETURN 
6000 REM " --- Check Mask"
6020 IF V$="" THEN GOTO 6090
6040 FOR X=1 TO LEN(V$)
6050 IF POS(V$(X,1)="#-")=0 THEN EXITTO 6080
6060 NEXT X
6070 GOTO 6090
6080 LET V$=""
6090 RETURN 
6100 REM " --- Test Mask"
6120 SETERR 6170
6130 PRINT @(0,22),0:V$,@(0,22),'CL',
6140 GOTO 6180
6170 LET V$=""
6180 SETERR 9000
6190 RETURN 
6200 REM " --- Mask Length"
6210 LET P0=0,M0$=""
6220 FOR X=1 TO LEN(A1$)
6230 IF POS("#"=A1$(X,1))<>0 THEN LET P0=P0+1,M0$=M0$+"0"
6240 IF POS("#"=A1$(X,1))=0 THEN LET M0$=M0$+A1$(X,1)
6280 NEXT X
6290 RETURN 
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM " --- Functions"
8145 REM " --- FNYY21_YY$ Un-Convert 21st Century 2-Char Year to 2-Char Year"
8150 DEF FNYY21_YY$(Q1$)
8155 LET Q3$=" 01234567890123456789",Q1$(1,1)=Q3$(POS(Q1$(1,1)=" 0123456789ABCDEFGHIJ"))
8160 RETURN Q1$
8165 FNEND
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 RUN "SYS.AA"
9999 END
