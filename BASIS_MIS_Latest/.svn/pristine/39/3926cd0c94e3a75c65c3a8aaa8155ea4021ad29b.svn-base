0010 REM "TMC - Called Routine to Calculate future date
0020 REM "Program: TMC.BA
0030 REM "ADD+ON SOFTWARE VERSION 5
0035 REM "12/05/91 by Jerry Koch
0040 REM "COPYRIGHT(C)1991 MicroAccounting Systems, Inc. ALL RIGHTS RESERVED
0050 ENTER D0$,D1$
0060 REM "D0$=Date (YYMMDD), D1$=Number of Days
0090 SETERR 9000
0095 SETESC 9900
1000 REM "INCREMENT DATE BY DAYS"
1020 REM "V0=Year, V1=Month, V2=Day
1040 LET V0=NUM(D0$(1,2)),V1=NUM(D0$(3,2)),V2=NUM(D0$(5,2))+NUM(D1$)
1060 LET V1$="312831303130313130313031"
1080 IF V2>0 THEN GOTO 1220
1100 LET V1=V1-1
1120 IF V1<1 THEN LET V1=12,V0=V0-1
1140 IF V0<0 THEN LET V0=99
1160 IF FPT(V0/4)=0 THEN LET V1$(3,2)="29"
1180 LET V2=NUM(V1$(V1*2-1,2))+V2
1200 GOTO 1060
1220 IF FPT(V0/2)=0 THEN LET V1$(3,2)="29"
1240 IF V2<=NUM(V1$(V1*2-1,2)) THEN GOTO 1340
1260 LET V2=V2-NUM(V1$(V1*2-1,2)),V1=V1+1
1280 IF V1>12 THEN LET V1=1,V0=V0+1
1300 IF V0>99 THEN LET V0=0
1320 GOTO 1060
1360 LET D0$=STR(V0:"00")+STR(V1:"00")+STR(V2:"00")
9900 EXIT 
