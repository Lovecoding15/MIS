0010 REM "GLM - Financial Report Maintenance (Detail)"
0020 REM "Program GLM.DC"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0040 REM 
0085 SETESC 9000
0090 SETERR 9000
0200 REM " --- IOLists"
0220 GLM22A: IOLIST B0$(1),B1$(1),B2$(1),B3$(1)
0500 REM " --- Init Data"
0510 LET B0$(1,4)=A0$(1,4)
0700 REM " --- Background"
0710 CALL "SYC.WC",1,0,80,0,0,9,0
0715 CALL "SYC.WC",1,0,80,0,0,12,0
0720 PRINT 'SB',@(6,6),"Line No:",@(4,7),"Line Type:",@(27),"Description:",@(5,8),"Position:",@(31),"Editing:",@(2,10),"Input Total:",@(0,11),"Input Percent:",@(21),"Accumulate? (Y/N):",@(0,13),"Total #",@(15),"Output No",@(35),"Operator",
0730 FOR X=1 TO 5
0740 PRINT @(2,X+13),X:"#.",
0750 NEXT X
0760 FOR X=0 TO 7
0770 PRINT @(10*X,19),"Column "+STR(X+1),
0780 NEXT X
0790 PRINT 'SF',
1000 REM " --- Key"
1010 PRINT 'CF',@(15,3),A0$(3,2),@(18),A0$(9,20),
1015 LET V4$="Enter The Detail Line Number (<F3>=Lookup)"
1020 LET V0$="Z",V1$="CEK",V2$="",V3$="",V0=4,V1=15,V2=6,I0=0,O9=0
1030 GOSUB 7000
1040 ON V3 GOTO 1050,1000,1000,1045,4500
1045 GOSUB 6000
1047 IF V$="" THEN GOTO 1000
1050 IF V<>0 THEN GOTO 1150
1060 LET K$=KEY(GLM22_DEV,END=1100)
1070 IF K$(1,4)<>A0$(1,4) THEN GOTO 1100
1080 LET B0$(1)=K$
1090 GOTO 1200
1100 LET X=NUM(B0$(5,4),ERR=1000)+10
1110 IF X>9999 THEN LET X=10
1120 LET B0$(5,4)=STR(X:"0000")
1130 GOTO 1200
1150 LET B0$(5,4)=V$
1200 REM " --- Find Key"
1210 IF B0$(5,4)="0000" THEN GOTO 1000
1220 PRINT @(15,6),B0$(5,4),
1230 FIND (GLM22_DEV,KEY=B0$(1,K9),DOM=1400)IOL=GLM22A
1300 REM " --- Display"
1320 GOSUB 5000
1390 GOTO 4000
1400 REM " --- New Record"
1410 CALL "SYC.YN",1,"Is This A New Record",2,V$,V3
1430 ON V3 GOTO 1440,1400,1000,1400,1000
1490 ON POS(V$="YN") GOTO 1400,1500,1000
1500 REM " --- Set Up"
1510 LET B1$(1)="",B2$(1)=""
1520 FOR X=0 TO 7
1530 LET B3$(3*X+1,3)=DEFAULT_POS$[X]
1540 NEXT X
1590 GOSUB 5000
2000 REM " --- Line Type"
2020 LET V0$="S",V1$="CR",V2$=B1$(1,1),V3$="HDBCTN",V4$="H=Heading  D=Detail  B=Beginning  C=Change  T=Total  N=Non-Printing",V0=1,V1=15,V2=7,I0=1,O9=1
2030 GOSUB 7000
2035 ON V3 GOTO 2040,2000,3900,2000,3900
2040 LET B1$(1,1)=V$
2090 GOTO 3900
2100 REM " --- Description"
2110 LET V4$="Enter a description for this detail line"
2120 LET V0$="S",V1$="C",V2$=B1$(2,35),V3$="",V0=35,V1=40,V2=7
2130 GOSUB 7000
2140 LET B1$(2,35)=V$
2190 GOTO 3900
2200 REM " --- Position"
2210 LET V4$="Enter a print position between 0 and 131"
2220 LET V0$="Z",V1$="C",V2$=B1$(37,3),V3$="",V0=3,V1=15,V2=8
2230 GOSUB 7000
2231 ON V3 GOTO 2232,2200,3900,2200,3900
2232 IF V=0 THEN GOTO 2240
2235 IF V>131 THEN GOTO 2200
2240 LET B1$(37,3)=STR(V:"000")
2290 GOTO 3900
2300 REM " --- Editing"
2320 LET V0$="S",V1$="CR",V2$=B1$(40,5),V3$="",V4$="S=Space U=Underline D=Dbl-Line P=Page -=Sign-Chng C=Clr-Total F=Un-Fav $=$ Mask",V0=5,V1=40,V2=8
2330 GOSUB 7000
2340 LET B1$(40,5)=V$
2350 FOR X=0 TO 4
2360 IF POS(B1$(40+X,1)="BSUDPC-F$ ")=0 THEN EXITTO 2300
2370 NEXT X
2380 PRINT @(0,22),'CL',
2390 GOTO 3900
2400 REM " --- Input Total"
2410 LET V4$="Enter the input total (0 through 255)"
2420 LET V0$="Z",V1$="C",V2$=B1$(45,3),V3$="",V0=3,V1=15,V2=10
2430 GOSUB 7000
2431 ON V3 GOTO 2432,2400,3900,2400,3900
2432 IF V=0 THEN GOTO 2440
2435 IF FNJ(V)=32 OR FNJ(V)=138 OR FNJ(V)>255 THEN GOSUB 5800; GOTO 2400
2440 LET B1$(45,3)=STR(V:"000")
2490 GOTO 3900
2500 REM " --- Input %"
2510 LET V4$="Enter the input percentage (0 through 255)"
2520 LET V0$="Z",V1$="C",V2$=B1$(48,3),V3$="",V0=3,V1=15,V2=11
2530 GOSUB 7000
2531 ON V3 GOTO 2532,2500,3900,2500,3900
2532 IF V=0 THEN GOTO 2540
2535 IF FNJ(V)=32 OR FNJ(V)=138 OR FNJ(V)>255 THEN GOSUB 5800; GOTO 2500
2540 LET B1$(48,3)=STR(V:"000")
2590 GOTO 3900
2600 REM " --- Accum"
2620 LET V0$="S",V1$="C",V2$=B1$(51,1),V3$=" YN",V4$="Y=Yes   N=No   <Enter>=Not Applicable",V0=1,V1=40,V2=11
2630 GOSUB 7000
2635 ON V3 GOTO 2640,2600,3900,2600,3900
2640 LET B1$(51,1)=V$
2690 GOTO 3900
3000 REM " --- Totals"
3100 FOR X=0 TO 4
3200 REM " --- Output Total"
3210 LET V4$="Enter the output total (0 through 255)"
3220 LET V0$="Z",V1$="C",V2$=B2$(3*X+1,3),V3$="",V0=3,V1=20,V2=X+14
3230 GOSUB 7000
3231 ON V3 GOTO 3232,3200,3232,3200,3232
3232 IF V=0 THEN GOTO 3240
3235 IF FNJ(V)=32 OR FNJ(V)=138 OR FNJ(V)>255 THEN GOSUB 5800; GOTO 3200
3240 LET B2$(3*X+1,3)=STR(V:"000")
3250 IF V3=4 THEN EXITTO 3900
3260 IF V3<>2 THEN GOTO 3300
3270 IF X=0 THEN EXITTO 3900
3280 LET X=X-1
3290 GOTO 3200
3300 REM " --- Operator"
3310 LET V4$="Enter the operator, plus or minus (+ or -)"
3320 LET V0$="S",V1$="C",V2$=B2$(X+16,1),V3$=" +-",V0=1,V1=40,V2=X+14
3330 GOSUB 7000
3340 LET B2$(X+16,1)=V$
3360 IF V3=2 THEN GOTO 3200
3390 NEXT X
3400 GOTO 3900
3500 REM " --- Columns"
3510 FOR X=0 TO 7
3600 REM " --- Column"
3610 LET V4$="Enter the column (0 through 131)"
3620 LET V0$="Z",V1$="C",V2$=B3$(3*X+1,3),V3$="",V0=3,V1=X*10+4,V2=20
3630 GOSUB 7000
3635 IF V>131 THEN GOTO 3600
3640 LET B3$(3*X+1,3)=STR(V:"000")
3650 IF V3=4 THEN EXITTO 3900
3660 IF V3<>2 THEN GOTO 3700
3670 IF X=0 THEN EXITTO 3000
3680 LET X=X-1
3690 GOTO 3520
3700 NEXT X
3900 REM " --- Next Field"
3910 IF V3=4 THEN GOTO 4000
3920 IF V3<>2 THEN GOTO 3940
3922 IF I0>0 THEN LET I0=I0-1
3930 GOTO 3950
3940 LET I0=I0+1
3950 LET V3=0
3960 ON I0 GOTO 1000,2000,2100,2200,2300,2400,2500,2600,3000,3500,3990
4000 REM " --- Correct?"
4010 LET V4$="Is The Above Information Correct (Y/N/Delete)?"
4020 LET V0$="S",V1$="CER",V2$="Y",V3$="",V0=6,V2=22,V1=FNV(V4$)
4030 GOSUB 7000
4040 ON V3 GOTO 4050,4000,4000,4000,4500
4060 IF V$="DELETE" THEN GOTO 4200
4090 ON POS(V$="YN") GOTO 4000,4100,2000
4100 REM " --- Write"
4120 WRITE (GLM22_DEV,KEY=B0$(1,K9))IOL=GLM22A
4190 GOTO 1000
4200 REM " --- Delete"
4220 REMOVE (GLM22_DEV,KEY=B0$(1,K9),DOM=4230)
4290 GOTO 1000
4500 REM " --- End"
4520 LET O0=1
4540 RUN "GLM.DA"
5000 REM " --- Display"
5020 PRINT @(15,7),B1$(1,1),@(40,7),B1$(2,35),@(15,8),B1$(37,3),@(40,8),B1$(40,5),@(15,10),B1$(45,3),@(15,11),B1$(48,3),@(40,11),B1$(51,1),
5040 FOR X=0 TO 4
5050 PRINT @(20,14+X),B2$(3*X+1,3),@(40),B2$(X+16,1),
5060 NEXT X
5070 FOR X=0 TO 7
5080 PRINT @(10*X+4,20),B3$(3*X+1,3),
5090 NEXT X
5100 RETURN 
5800 REM " --- Invalid Number"
5820 LET V4$="The number "+STR(V)+" cannot be used (<Enter>=Continue):"
5830 LET V0$="S",V1$="C",V2$="",V3$="",V0=1,V1=FNV(V4$),V2=22
5840 GOSUB 7000
5890 RETURN 
6000 REM " --- Line lookup"
6010 LET REPORT$=B0$(3,2),V=0
6020 CALL "GLC.LL",REPORT$,N0$,V$
6030 LET V=NUM(V$,ERR=6040)
6090 RETURN 
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM " --- Functions"
8060 DEF FNJ(Q)=Q+32
8090 DEF FNV(Q$)=42+INT(LEN(Q$)/2)
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- <F4>/END Option For Locked Record"
9210 LET O0=1
9220 IF ERR=0 THEN RUN "GLM.DA"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 RUN "SYS.AA"
9999 END
