0010 REM "ADC - External Call To Unix Print Spooler"
0020 REM "PROGRAM: ADC.10"
0030 REM "+----------------------------------------------------------+"
0031 REM "|            ADminstrator System Version 1.0.2a            |
0032 REM "|     Copyright (C) 1994 MicroAccounting Systems, Inc.     |
0033 REM "|                 All Rights Reserved"                     |
0034 REM "+----------------------------------------------------------+
0045 DIM INCLUDE$[11]
0050 ENTER DATAPATH$,FILE$,PRINTER$,INCLUDE$[ALL]
0090 SETERR 9000
0530 CALL "ADC.04",OS$
0540 IF OS$<>"UNIX" THEN GOSUB 6250
0550 LET METHOD$="cat "
0610 GOSUB 6000
0620 LET PRINTER_CHANNEL=UNT; CALL "ADC.GB",PRINTER_CHANNEL,0,"",PRINTER$,V1
0625 LET PRINTER$=FID(PRINTER_CHANNEL,ERR=9900)
0630 IF V1=0 THEN CLOSE (PRINTER_CHANNEL,ERR=0631) ELSE GOTO 9900
1000 REM "CHECK PRINTER"
1020 IF LEN(PRINTER$)=0 THEN GOTO 9900
1200 REM "CHECK FOR INCLUDE FILE"
1210 FOR J=0 TO 11
1220 IF INCLUDE$[J]="" OR POS(".fax"=FNT$(INCLUDE$[J]))>0 THEN GOTO 1280
1240 LET COMMAND$=COMMAND$+" "+INCLUDE$[J]
1280 NEXT J
1400 REM "---- Finish Command Construction"
1440 LET COMMAND$=METHOD$+DATAPATH$+"/"+FILE$+COMMAND$+PIPE$
4020 CALL "ADC.OS",COMMAND$
4190 GOTO 9900
6000 REM "---- Get Print Device From BBCONFIG"
6005 FOR J=0 TO 512
6010 LET X$=TSK(J,ERR=6200)
6012 IF POS(PRINTER$=X$)=0 THEN GOTO 6210
6015 IF LEN(X$)<3 THEN GOTO 6210
6020 LET X$=X$(3),P0=0,P1=0
6025 DIM DEVICE$[4]
6030 LET P0=POS($00$=X$),P1=P1+1
6040 IF P0=0 THEN GOTO 6100
6050 LET DEVICE$[P1]=X$(1,P0-1)
6055 IF LEN(X$)=P0 THEN GOTO 6100
6060 LET X$=X$(P0+1)
6090 GOTO 6030
6120 IF POS(">"=DEVICE$[3])=1 THEN LET PIPE$=" | "+DEVICE$[3](2) ELSE LET PIPE$=" > "+DEVICE$[3]
6180 EXITTO 6220
6190 GOTO 6201
6200 EXITTO 6250
6210 NEXT J
6220 GOTO 6270
6250 LET TMODE=0,TWIDTH=65,THEIGHT=3,TXPOS=10,TYPOS=20,TTITLE$="VsiFax Print Error!",TNAME$=""; CALL "ADC.WA",TMODE,TWIDTH,THEIGHT,TXPOS,TYPOS,TTITLE$,TNAME$; LET V0$="S",V1$="",V2$="",V3$="",V4$="",V0=1,V1=58,V2=0; PRINT @(1,0),$07$+"Error Getting Unix Printer Information! <CR>=Continue:",; GOSUB 7000; LET ERROR$="YES"
6260 CALL "ADC.WD",ERR=6261,TNAME$
6285 IF ERROR$="YES" THEN EXITTO 9900
6290 RETURN 
7000 REM " --- User Input Routine"
7020 CALL "ADC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-1),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7040 IF V3=5 THEN GOTO 7100
7050 IF V3=6 THEN GOTO 7200
7085 LET I$=V$
7090 RETURN 
7100 REM " --- Error During Input"
7200 REM " --- Escape Requested"
7210 PRINT @(0,22),'CL','CURSOR'("ON"),
7220 ESCAPE
7290 GOTO 7000
7300 REM "---- Special User Input"
7320 CALL "ADC.IB",V0$,V1$,V2$,V3$,V4$,PGM(-1),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7330 IF V3<5 OR V3>6 THEN GOTO 7350
7340 ESCAPE
7390 RETURN 
8000 REM "---- Functions"
8020 DEF FNL$(Q$)=CVS(Q$,1); REM "---- Leading Blanks
8040 DEF FNP$(Q$)=CVS(Q$,2); REM "---- Trailing Blanks
8050 DEF FNQ$(Q$)=CVS(Q$,16); REM "---- Unprintable Characters
8060 DEF FNS$(Q$)=CVS(Q$,1+2); REM "---- Leading & Trailing Blanks
8070 DEF FNT$(Q$)=CVS(Q$,8); REM "----- Lowercase"
8080 DEF FNU$(Q$)=CVS(Q$,4); REM "---- Uppercase
9900 REM "EXIT"
9910 CLOSE (STRING_DEV,ERR=9911)
9999 END
