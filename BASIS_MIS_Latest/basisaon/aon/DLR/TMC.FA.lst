0010 REM "TMC - Called Routine: Create Customer from Contact
0020 REM "Program TMC.FA
0030 REM "ADD+ON SOFTWARE VERSION 5
0035 REM "12/18/91 by Jerry Koch
0040 REM "Copyright(C)1991 MicroAccounting Systems, Inc. ALL RIGHTS RESERVED
0041 REM 
0042 REM "06/07/96 KJS WA: #211 <F9> is now quick exit"
0079 REM 
0080 SETERR 9000
0090 ENTER A0$,V3
0100 REM "OPEN FILES
0110 LET SYS01_DEV=UNT; OPEN (SYS01_DEV,ERR=9900)"SYS-01"
0115 LET X$=STBL("SYS01_DEV",STR(SYS01_DEV))
0120 LET ARM01_DEV=UNT; OPEN (ARM01_DEV,ERR=9900)"ARM-01"
0125 LET X$=STBL("ARM01_DEV",STR(ARM01_DEV))
0130 LET ARM02_DEV=UNT; OPEN (ARM02_DEV,ERR=9900)"ARM-02"
0135 LET X$=STBL("ARM02_DEV",STR(ARM02_DEV))
0140 LET ARM04_DEV=UNT; OPEN (ARM04_DEV,ERR=9900)"ARM-04"
0145 LET X$=STBL("ARM04_DEV",STR(ARM04_DEV))
0150 LET ARM10_DEV=UNT; OPEN (ARM10_DEV,ERR=9900)"ARM-10"
0155 LET X$=STBL("ARM10_DEV",STR(ARM10_DEV))
0160 LET ARS10_DEV=UNT; OPEN (ARS10_DEV,ERR=9900)"ARS-10"
0165 LET X$=STBL("ARS10_DEV",STR(ARS10_DEV))
0220 IOLIST B0$(1),B1$(1)
0230 IOLIST C0$,C1$,C[0],C[1],C[2],C[3],C[4],C[5],C[6]
0250 IOLIST P0$,P1$,P2$
0260 IOLIST I0$,I1$,I2$,I3$,I4$,M0$,M1$,M2$,M3$
0270 IOLIST X$,F0$,X$,X$,F4$,F5$
0280 ARS10N: IOLIST Y0$,Y[ALL]
0300 REM IOLIST Y0$,Y[0],Y[1],Y[2]
0400 REM "PARAMETERS
0410 FIND (SYS01_DEV,KEY="T"+FID(0),DOM=9900)IOL=0270
0420 LET N0$=F0$(16,2),M0$="000000"
0445 FIND (SYS01_DEV,KEY=N0$+"TM"+"00",DOM=9900)IOL=0250
0450 DIM P[2]
0455 LET P[0]=6
0460 FIND (SYS01_DEV,KEY=N0$+"AR"+"00",DOM=0491)IOL=0260
0490 LET P[0]=NUM(I2$(1,2)),P[1]=NUM(I2$(3,2)),P[2]=NUM(I3$(4,1))
0500 REM --INIT DATA--
0520 DIM J0$(20,"0"),J$(78,"-"),J1$(30)
0530 DIM DESC$[100](60),CONTACT$(20),B0$(8),B1$(305),C0$(10),C1$(64),C[6],Y[4]
0560 LET L0=1,L9=12,X1=1,X0=0,M8$="(###)-###-####"
0570 IF P[2]=9 THEN LET M7$="00000-0000" ELSE LET M7$="0000"
0580 DIM LINE[5]; LET LINE[1]=31,LINE[2]=55,LINE[3]=79,LINE[4]=179,LINE[5]=203
0590 IF NUM(A0$(253,6))=0 THEN LET A0$(253,6)=""
0600 REM "--- Make Window
0610 LET WIDTH=80,HEIGHT=20,WIN_X=0,WIN_Y=3
0620 LET TITLE$="Create Customer from Contact",NAME$=CVS(TITLE$(1,8),2),X$=STBL("WINDOW_NAME",NAME$)
0630 DIM HEADING$(WIDTH-2),FOOTING$(WIDTH-2); LET HEADING$(4)="Date",HEADING$(11)="Comment Information",FOOTING$(1)="                      F4=End"
0640 CALL "SYC.WA",0,WIDTH,HEIGHT,WIN_X,WIN_Y,TITLE$,NAME$
0700 REM "BACKGROUND"
0720 PRINT 'SB',
0730 PRINT @(2,0),"Customer No:",@(23,0),"Company Name:",@(0,1),J$,
0740 PRINT @(7,2),"Addr 1:",@(46,2),"Alt Seq:",@(7,3),"Addr 2:",@(42,3),"Date Opened:",@(7,4),"Addr 3:",@(45,4),"Ship-Via:",@(7,5),"Addr 4:",@(44,5),"Resale No:",@(7,6),"Addr 5:",@(44,6),"Alt Phone:",@(5,7),"Zip Code:",@(46,7),"Contact:",@(4,8),"Telephone:",@(47,8),"Retain:",@(0,9),J$,
0750 PRINT @(2,10),"Salesperson:",@(42,10),"Finance Charge?:",@(3,11),"Terms Code:",@(42,11),"Sales Analysis?:",@(4,12),"Territory:",@(46,12),"Statements?:",@(4,13),"Dist Code:",@(45,13),"Pricing Code:",@(2,14),"Std Message:",@(47,14),"Label Code:",@(0,15),"Sale Discount:",@(44,15),"Customer Type:",@(5,16),"Tax Code:",@(45,16),"Credit Limit:",
0760 PRINT 'SF',
0800 FIND (ARM01_DEV,KEY=N0$+A0$(253,6),DOM=1000)IOL=0220
0805 GOSUB 5000
0810 LET V0$="Y",V1$="C",V2$="Y",V3$="",V4$="Customer Record Exists For This Contact!  Update It? <Y/N>: ",V0=1,V1=41+INT(LEN(V4$)/2),V2=22
0815 GOSUB 7000
0820 IF V$<>"Y" THEN GOTO 9900
0825 CALL "TMC.EA",A0$
0830 LET P9$="Y",DEL$="/END"
0835 EXTRACT (ARM01_DEV,KEY=N0$+A0$(253,6))IOL=0220
0840 FIND (ARM02_DEV,KEY=N0$+A0$(253,6)+"  ",DOM=9900)IOL=0230
0850 GOSUB 5000
0990 GOTO 3900
1000 REM "--- Extract Next Customer Number
1020 DIM J9$(P[0],"9")
1040 GOSUB 3500
1060 LET A0$(253,6)=V$
1080 FIND (ARM01_DEV,KEY=N0$+A0$(5,6),DOM=1100)
1090 GOTO 1000
1100 REM "--- Make New Customer Record
1110 LET B0$=N0$+A0$(253,6),C0$=B0$+"  "
1120 WRITE (ARM01_DEV,KEY=B0$)IOL=0220
1125 WRITE (ARM02_DEV,KEY=B0$+"  ")IOL=0230
1130 CALL "TMC.EA",A0$
1140 EXTRACT (ARM01_DEV,KEY=B0$)IOL=0220
1145 EXTRACT (ARM02_DEV,KEY=B0$+"  ")IOL=0230
1150 LET DEL$="/DELETE"
1160 LET B1$(1,30)=A0$(112),B1$(146,10)=A0$(112),B1$(228,20)=A0$(52),B1$(227,1)="Y",B1$(156,3)=F0$(7,3)
1170 GOSUB 6000
1175 LET C1$(10,2)="YI",C1$(20,1)="Y"
1180 GOSUB 5000
1190 GOTO 2000
1200 REM "ADDRESS LINE 4
1220 LET V0$="S",V1$="",V2$=B1$(179,24),V3$="",V0=24,V1=15,V2=5
1240 GOSUB 7000
1250 LET B1$(179,24)=V$
1290 GOTO 3900
1300 REM "ADDRESS LINE 5"
1320 LET V0$="S",V1$="",V2$=B1$(203,22),V3$="",V0=24,V1=15,V2=6
1340 GOSUB 7000
1350 LET B1$(203,22)=V$
1390 GOTO 3900
1400 REM "DATE OPENED"
1420 LET V0$="D",V1$="C",V2$=B1$(156,3),V0=3,V1=55,V2=3,V4$="Enter/Edit Date Account Opened"
1440 GOSUB 7000
1450 LET B1$(156,3)=V$
1490 GOTO 3900
1500 REM "SHIP VIA"
1520 LET V0$="S",V1$="C",V2$=B1$(159,10),V0=10,V1=55,V2=4,V4$="Enter Std Shipping Method"
1540 GOSUB 7000
1550 LET B1$(159,10)=V$
1590 GOTO 3900
1600 REM "RESALE NO"
1620 LET V0$="S",V1$="C",V2$=B1$(126,20),V0=20,V1=55,V2=5,V4$="Enter Account Resale Number If Applicable"
1640 GOSUB 7000
1650 LET B1$(126,20)=V$
1690 GOTO 3900
1700 REM "ALT PHONE"
1720 LET V0$="H",V1$="C",V2$=B1$(169,10),V3$=M8$,V0=10,V1=55,V2=6,V4$="Enter Alternate Phone Number"
1740 GOSUB 7000
1750 LET B1$(169,10)=V$
1790 GOTO 3900
1800 REM "CONTACT"
1820 LET V0$="S",V1$="C",V2$=B1$(228,20),V3$="",V0=20,V1=55,V2=7,V4$="Enter/Edit Customer Contact"
1840 GOSUB 7000
1850 LET B1$(228,20)=V$
1890 GOTO 3900
1900 REM "STD MESSAGE"
1910 IF P9$="Y" THEN GOTO 3900
1920 LET V0$="S",V1$="C",V2$=C1$(30,2),V3$="",V0=2,V1=15,V2=14,V4$="Enter Std Message Code, <F3>=Lookup"
1940 GOSUB 7000
1950 IF V3<>3 THEN GOTO 1980
1960 LET V4=1,V5=ARM10_DEV,V6=4,V7=2,V8=7,V9=20,V5$="G"
1970 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
1980 LET C1$(30,2)=V$
1985 FIND (ARM10_DEV,KEY=N0$+"G"+C1$(30,2)+"1",DOM=1986)X0$
1987 PRINT @(19,V2),X0$(7,20),
1990 GOTO 3900
2000 REM "NAME
2020 LET V0$="S",V1$="",V2$=B1$(1,30),V3$="",V0=30,V1=37,V2=0,I0=0
2040 GOSUB 7000
2060 LET B1$(1,30)=V$
2070 IF POS(" "<>B1$(146,10))=0 THEN LET B1$(146,10)=B1$(1,10)
2090 GOTO 3900
2100 REM "ADDRESS 1
2120 LET V0$="S",V1$="",V2$=B1$(31,24),V3$="",V0=24,V1=15,V2=2
2140 GOSUB 7000
2150 LET B1$(31,24)=V$
2190 GOTO 3900
2200 REM "ADDRESS 2
2220 LET V0$="S",V1$="",V2$=B1$(55,24),V3$="",V0=24,V1=15,V2=3
2240 GOSUB 7000
2250 LET B1$(55,24)=V$
2290 GOTO 3900
2300 REM "ADDRESS 3
2320 LET V0$="S",V1$="",V2$=B1$(79,24),V3$="",V0=24,V1=15,V2=4
2340 GOSUB 7000
2350 LET B1$(79,24)=V$
2390 GOTO 3900
2400 REM "ZIP CODE
2420 LET V0$="S",V1$="C",V2$=B1$(103,P[2]),V0=P[2],V1=15,V2=7,V3$="",V4$="Enter A "+STR(P[2])+" Digit Zip Code"
2440 GOSUB 7000
2445 IF LEN(V$)<9 THEN LET V$=V$+J1$(1,9-LEN(V$))
2450 LET B1$(103,9)=V$
2460 PRINT @(V1,V2),FNZ$(B1$(103,P[2]))
2490 GOTO 3900
2500 REM "TELEPHONE
2520 LET V0$="H",V1$="",V2$=B1$(112,10),V3$=M8$,V0=10,V1=15,V2=8
2540 GOSUB 7000
2550 LET B1$(112,10)=V$
2590 GOTO 3900
2600 REM "TERRITORY
2610 IF P9$="Y" THEN GOTO 3900
2620 LET V0$="S",V1$="",V2$=C1$(21,3),V3$="",V0=3,V1=15,V2=12,V4$="Enter A Valid Territory, <F3>=Look-Up"
2630 GOSUB 7000
2632 IF V3<>3 THEN GOTO 2640
2634 LET V4=1,V5=ARM10_DEV,V6=4,V7=3,V8=7,V9=20,V5$="H"
2636 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
2650 LET C1$(21,3)=V$
2660 FIND (ARM10_DEV,KEY=N0$+"H"+C1$(21,3),DOM=2600)X0$
2670 PRINT @(19,V2),X0$(7,20),
2690 GOTO 3900
2700 REM "TAX CODE
2710 IF P9$="Y" THEN GOTO 3900
2720 LET V0$="S",V1$="",V2$=C1$(32,2),V3$="",V0=2,V1=15,V2=16,V4$="Enter A Valid Tax Code, <F3>=Look-Up"
2730 GOSUB 7000
2732 IF V3<>3 THEN GOTO 2750
2734 LET V4=1,V5=ARM10_DEV,V6=4,V7=2,V8=6,V9=20,V5$="B"
2740 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
2750 LET C1$(32,2)=V$
2760 FIND (ARM10_DEV,KEY=N0$+"B"+C1$(32,2),DOM=2700)X0$
2770 PRINT @(19,V2),X0$(6,20),
2790 GOTO 3900
2800 REM "TERMS"
2810 IF P9$="Y" THEN GOTO 3900
2820 LET V0$="S",V1$="R",V2$=C1$(4,2),V3$="",V0=2,V1=15,V2=11,V4$="Enter A Valid Terms Code, <F3>=Look-Up"
2830 GOSUB 7000
2832 IF V3<>3 THEN GOTO 2840
2834 LET V4=1,V5=ARM10_DEV,V6=4,V7=2,V8=6,V9=20,V5$="A"
2836 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
2850 LET C1$(4,2)=V$
2860 FIND (ARM10_DEV,KEY=N0$+"A"+C1$(4,2),DOM=2800)X0$
2870 PRINT @(19,V2),X0$(6,20),
2890 GOTO 3900
2900 REM "DISTRIBUTION
2910 IF P9$="Y" THEN GOTO 3900
2920 LET V0$="S",V1$="R",V2$=C1$(8,2),V3$="",V0=2,V1=15,V2=13,V4$="Valid G/L Distribution Code, <F3>=Look-Up"
2930 GOSUB 7000
2932 IF V3<>3 THEN GOTO 2940
2934 LET V4=1,V5=ARM10_DEV,V6=4,V7=2,V8=6,V9=20,V5$="D"
2936 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
2950 LET C1$(8,2)=V$
2960 FIND (ARM10_DEV,KEY=N0$+"D"+C1$(8,2),DOM=2900)X0$
2970 PRINT @(19,V2),X0$(6,20),
2990 GOTO 3900
3000 REM "SALE DISCOUNT
3010 IF P9$="Y" THEN GOTO 3900
3020 LET V0$="S",V1$="",V2$=C1$(6,2),V3$="",V0=2,V1=15,V2=15,V4$="Enter A Valid Discount Code, <F3>=Look-Up"
3030 GOSUB 7000
3032 IF V3<>3 THEN GOTO 3040
3034 LET V4=1,V5=ARM10_DEV,V6=4,V7=2,V8=6,V9=20,V5$="I"
3036 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
3050 LET C1$(6,2)=V$
3060 FIND (ARM10_DEV,KEY=N0$+"I"+C1$(6,2),DOM=3000)X0$
3080 PRINT @(19,V2),X0$(6,20),
3090 GOTO 3900
3100 REM "SALESPERSON
3110 IF P9$="Y" THEN GOTO 3900
3120 LET V0$="S",V1$="",V2$=C1$(1,3),V3$="",V0=3,V1=15,V2=10,V4$="Enter A Valid Salesperson Code, <F3>=Look-Up"
3130 GOSUB 7000
3132 IF V3<>3 THEN GOTO 3140
3134 LET V4=1,V5=ARM10_DEV,V6=4,V7=3,V8=7,V9=20,V5$="F"
3136 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
3150 LET C1$(1,3)=V$
3160 FIND (ARM10_DEV,KEY=N0$+"F"+C1$(1,3),DOM=3100)X0$
3170 PRINT @(19,V2),X0$(7,20),
3190 GOTO 3900
3200 REM "PRICE CLASS
3210 IF P9$="Y" THEN GOTO 3900
3220 LET V0$="S",V1$="",V2$=C1$(24,4),V0=4,V1=59,V2=13,V4$="Enter A 4 Character Pricing Code"
3240 GOSUB 7000
3250 LET C1$(24,4)=V$
3260 PRINT @(V1,V2),C1$(24,4),
3290 GOTO 3900
3300 REM "SEARCH KEY
3320 LET V0$="S",V1$="",V2$=B1$(146,10),V0=10,V1=55,V2=2,V4$="Enter A 10 Character Alpha Search Key"
3340 GOSUB 7000
3350 LET B1$(146,10)=V$
3390 GOTO 3900
3400 REM "RETAIN"
3420 LET V0$="Y",V1$="C",V2$=B1$(227,1),V3$="",V4$="Y=Retain Customer After Invoice Is Removed, N=Do Not Retain",V1=55,V2=8
3440 GOSUB 7000
3460 LET B1$(227,1)=V$
3490 GOTO 3900
3500 REM "GET NEXT CUST NUMBER
3501 GOTO 16000
3520 EXTRACT (SYS01_DEV,KEY=N0$+"SY99",DOM=3530)IOL=0300
3525 GOTO 3550
3530 LET Y[1]=1000,Y0$=N0$+"SY99"
3550 LET X8=Y[1]; LET Y[1]=Y[1]+1; IF Y[1]>NUM(J9$) THEN EXITTO 3600
3560 WRITE (SYS01_DEV,KEY=N0$+"SY99")IOL=0300
3570 FIND (ARM01_DEV,KEY=N0$+STR(X8:"000000"),DOM=3590)
3575 GOTO 3500
3590 RETURN 
3600 REM "OVERFLOW ON CUST #
3610 LET OWIDTH=76,OHEIGHT=4,OWIN_X=2,OWIN_Y=15,OTITLE$="",ONAME$="ERR"
3620 CALL "SYC.WA",0,OWIDTH,OHEIGHT,OWIN_X,OWIN_Y,OTITLE$,ONAME$
3650 PRINT @(10,0),"Automatic Customer Numbers Greater Than ",J9$,", Please",@(10,1),"Reset Next Automatic Numbers <Cr To End>: ",
3660 LET V0$="S",V1$="",V2$="",V3$="",V4$="",V0=1,V1=52,V2=1
3670 GOSUB 7000
3680 CALL "SYC.WD",ONAME$
3690 GOTO 9900
3700 REM "CUSTOMER TYPE"
3710 IF P9$="Y" THEN GOTO 3900
3720 LET V0$="S",V1$="C",V2$=C1$(34,3),V4$="Enter A Valid Customer Type, <F3>=Look-Up",V0=3,V1=59,V2=15
3730 GOSUB 7000
3732 IF V3<>3 THEN GOTO 3740
3734 LET V4=1,V5=ARM10_DEV,V6=4,V7=3,V8=7,V9=20,V5$="L"
3736 PRINT @(0,22),'CL',; CALL "ADC.LK",V1,V2,V4,V5,V6,V7,V8,V9,V$,V5$,N0$
3740 LET C1$(34,3)=V$
3750 FIND (ARM10_DEV,KEY=N0$+"L"+C1$(34,3),DOM=3700)X0$
3760 PRINT @(V1+4,V2),X0$(7,15),
3790 GOTO 3900
3900 REM "NEXT FIELD
3905 IF V3=9 THEN GOTO 4100
3910 IF V3<>2 THEN GOTO 3940
3920 IF I0>0 THEN LET I0=I0-1
3930 GOTO 3950
3940 LET I0=I0+1
3950 IF V3=4 THEN GOTO 3990
3960 ON I0 GOTO 2000,2100,2200,2300,1200,1300,2400,2500,3300,1400,1500,1600,1700,1800,3400,3100,2800,2600,2900,1900,3000,2700,8300,8400,8500,3200,8600,3700,8700,3990
4000 REM "OPTIONS
4020 LET V0$="S",V1$="C",V2$="",V3$="",V4$="Is The Above Information Correct? <Y/N"+DEL$+"/F9=quit>: ",V0=6,V1=41+INT(LEN(V4$)/2),V2=22
4030 GOSUB 7000
4035 IF V3=9 THEN GOTO 4100
4040 IF V$="DELETE" AND DEL$="/DELETE" THEN GOSUB 5500; GOTO 9900
4050 IF DEL$="/END" THEN IF V3=4 OR V$="END" THEN GOTO 9900
4090 ON POS(V$="YN") GOTO 4000,4100,2000
4100 REM "WRITE
4120 WRITE (ARM01_DEV,KEY=B0$)IOL=0220
4140 WRITE (ARM02_DEV,KEY=C0$)IOL=0230
4150 WRITE (ARM04_DEV,KEY=N0$+"A"+B1$(146,10)+B0$(3,6))
4160 WRITE (ARM04_DEV,KEY=N0$+"B"+C1$(1,3)+B0$(3,6))
4170 WRITE (ARM04_DEV,KEY=N0$+"C"+C1$(21,3)+B0$(3,6))
4180 WRITE (ARM04_DEV,KEY=N0$+"E"+B1$(103,9)+B0$(3,6))
4290 GOTO 9900
5000 REM "--- Display
5010 LET X1=0
5020 PRINT @(15,0),FNF$(B0$(3,P[0]),M0$),@(37,0),B1$(1,30),
5040 FOR X=0 TO 4
5050 IF X>2 THEN LET X1=76
5060 PRINT @(15,X+2),B1$(X*24+31+X1,24),
5080 NEXT X
5090 PRINT @(55,2),B1$(146,10),@(55,3),FNB$(B1$(156,3)),@(55,4),B1$(159,10),@(55,5),B1$(126,20),@(55,6),FNF$(B1$(169,10),M8$),@(15,7),FNZ$(B1$(103,P[2])),@(55,7),B1$(228,20),@(15,8),FNF$(B1$(112,10),M8$),@(55,8),B1$(227,1),
5290 RETURN 
5500 REM "DECREMENT NEXT CUST #
5520 EXTRACT (SYS01_DEV,KEY=N0$+"SY00",DOM=5540)IOL=0300
5530 IF NUM(B0$(3,6))+1=Y[1] THEN LET Y[1]=Y[1]-1 ELSE GOTO 5580
5540 GOTO 5560
5550 LET Y[1]=1000
5570 WRITE (SYS01_DEV)IOL=0300
5580 REMOVE (ARM01_DEV,KEY=B0$,DOM=5581)
5585 LET A0$(253,6)=""
5590 RETURN 
6000 REM "---Check Codes & Set Defaults
6005 LET X9$="OKAY"
6009 IF C1$(38,1)=J1$(1,1) THEN LET C1$(38,1)=I3$(78,1)
6010 IF C1$(1,3)=J1$(1,3) THEN LET C1$(1,3)=I3$(55,3)
6015 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"F"+C1$(1,3),DOM=6025)X0$
6020 GOTO 6035
6025 IF C1$(1,3)<>I3$(55,3) THEN LET C1$(1,3)=I3$(55,3); GOTO 6015
6030 LET X9$="NKAY"
6035 PRINT @(15,10),C1$(1,3),@(19,10),X0$(7,20),
6040 IF C1$(4,2)=J1$(1,2) THEN LET C1$(4,2)=I3$(60,2)
6045 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"A"+C1$(4,2),DOM=6055)X0$
6050 GOTO 6065
6055 IF C1$(4,2)<>I3$(60,2) THEN LET C1$(4,2)=I3$(60,2); GOTO 6045
6060 LET X9$="NKAY"
6065 PRINT @(15,11),C1$(4,2),@(19,11),X0$(6,20),
6070 IF C1$(21,3)=J1$(1,3) THEN LET C1$(21,3)=I3$(52,3)
6075 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"H"+C1$(21,3),DOM=6085)X0$
6080 GOTO 6100
6085 IF C1$(21,3)<>I3$(52,3) THEN LET C1$(21,3)=I3$(52,3); GOTO 6075
6090 LET X9$="NKAY"
6100 PRINT @(15,12),C1$(21,3),@(19,12),X0$(7,20),
6105 IF C1$(8,2)=J1$(1,2) THEN LET C1$(8,2)=I3$(62,2)
6110 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"D"+C1$(8,2),DOM=6120)X0$
6115 GOTO 6130
6120 IF C1$(8,2)<>I3$(62,2) THEN LET C1$(8,2)=I3$(62,2); GOTO 6110
6125 LET X9$="NKAY"
6130 PRINT @(15,13),C1$(8,2),@(19,13),X0$(6,20),
6140 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"G"+C1$(30,2)+"1",DOM=6150)X0$
6145 GOTO 6160
6155 LET X9$="NKAY"
6160 PRINT @(15,14),C1$(30,2),@(19,14),X0$(7,20),
6165 IF C1$(6,2)=J1$(6,2) THEN LET C1$(6,2)=I3$(50,2)
6170 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"I"+C1$(6,2),DOM=6180)X0$
6175 GOTO 6190
6180 IF C1$(6,2)<>I3$(50,2) THEN LET C1$(6,2)=I3$(50,2); GOTO 6175
6185 LET X9$="NKAY"
6190 PRINT @(15,15),C1$(6,2),@(19,15),X0$(6,20),
6200 IF C1$(32,2)=J1$(1,2) THEN LET C1$(32,2)=I3$(58,2)
6205 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"B"+C1$(32,2),DOM=6215)X0$
6210 GOTO 6225
6215 IF C1$(32,2)<>I3$(58,2) THEN LET C1$(32,2)=I3$(58,2); GOTO 6205
6220 LET X9$="NKAY"
6225 PRINT @(15,16),C1$(32,2),@(19,16),X0$(6,20),
6250 PRINT @(59,10),C1$(10,1),@(59,11),C1$(11,1),@(59,12),C1$(20,1),@(59,13),C1$(24,4),@(59,14),C1$(28,2),@(59,15),C1$(34,3),@(59,16),C[6]:M2$,
6260 DIM X0$(30); FIND (ARM10_DEV,KEY=N0$+"L"+C1$(34,3),DOM=6270)X0$
6265 GOTO 6290
6275 LET X9$="NKAY"
6280 PRINT @(59,15),C1$(34,3)," ",X0$(7,15),
6380 REM IF X9$="NKAY" THEN GOSUB 6400
6385 IF C1$(24,4)=J1$(1,4) THEN LET C1$(24,4)=I3$(94,4)
6386 IF C1$(34,3)=J1$(1,3) THEN LET C1$(34,3)=I3$(98,3)
6390 RETURN 
6400 REM "--- Missing Default Not Found
6401 ESCAPE
6410 LET OWIDTH=76,OHEIGHT=4,OWIN_X=2,OWIN_Y=15,OTITLE$="",ONAME$="ERR"
6420 CALL "SYC.WA",0,OWIDTH,OHEIGHT,OWIN_X,OWIN_Y,OTITLE$,ONAME$
6450 PRINT @(10,0),"The Default/Pre-Set Value Is Not On File",@(10,1),"<Cr> To Continue. ",
6460 LET V0$="S",V1$="",V2$="",V3$="",V4$="",V0=1,V1=28,V2=1
6470 GOSUB 7000
6480 CALL "SYC.WD",ONAME$
6490 RETURN 
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM "FUNCTIONS"
8010 DEF FNA$(Q$,Q2$)=STR((ASC(Q$)-32)*POS(" "<>Q2$(2,1)):"00")
8020 DEF FNB$(Q1$)=FNA$(Q1$(2),Q1$)+"/"+FNA$(Q1$(3),Q1$)+"/"+FNA$(Q1$(1),Q1$)
8030 DEF FNC$(Q1$)=FNA$(Q1$(2),Q1$)+FNA$(Q1$(3),Q1$)+FNA$(Q1$(1),Q1$)
8040 DEF FND$(Q$)=CHR(NUM(Q$(5,2))+32)+CHR(NUM(Q$(1,2))+32)+CHR(NUM(Q$(3,2))+32)
8050 DEF FNE$(Q$)=STR(INT(TIM):"00")+":"+STR(FPT(TIM)*60:"00")
8060 DEF FNF$(Q$,Q1$)=STR(-NUM(Q$):Q1$)
8070 DEF FNG$(Q$)=STR((ASC(Q$)-32)*POS(" "<>Q$):"000")
8085 DEF FNZ$(Q$)=FILL(10,CVS(Q$(1,3)+FILL(POS("9"<Q$(1,5))>0)+Q$(4,2)+FILL(ABS(POS("A">=Q$(1,6))>0)-POS("0">Q$(6,4))>0,"-")+Q$(6,4)+FILL(10),16))
8300 REM "FINANCE CHARGE"
8310 IF P9$="Y" THEN GOTO 3900
8320 LET V0$="Y",V1$="C",V2$=C1$(10,1),V3$="",V1=59,V2=10,V4$="If Calculated Should A Finance Charge Be Applied <Y/N>"
8340 GOSUB 7000
8350 LET C1$(10,1)=V$
8390 GOTO 3900
8400 REM "SALES ANALYSIS"
8410 IF P9$="Y" THEN GOTO 3900
8420 LET V0$="S",V1$="C",V2$=C1$(11,1),V3$="",V0=1,V1=59,V2=11,V4$="P=Product Summary I=Item Detail, N=None"
8440 GOSUB 7000
8450 IF POS(V$="PIN")=0 THEN GOTO 8400
8460 LET C1$(11,1)=V$
8490 GOTO 3900
8500 REM "STATEMENTS"
8510 IF P9$="Y" THEN GOTO 3900
8520 LET V0$="Y",V1$="C",V2$=C1$(20,1),V3$="",V1=59,V2=12,V4$="If Printed - Statements For This Customer?"
8540 GOSUB 7000
8550 LET C1$(20,1)=V$
8590 GOTO 3900
8600 REM "LABEL CODE"
8610 IF P9$="Y" THEN GOTO 3900
8620 LET V0$="S",V1$="C",V2$=C1$(28,2),V3$="",V0=2,V1=59,V2=14,V4$="Enter Label Code For This Customer"
8640 GOSUB 7000
8650 LET C1$(28,2)=V$
8690 GOTO 3900
8700 REM "CREDIT LIMIT"
8710 IF P9$="Y" THEN GOTO 3900
8720 LET V0$="N",V1$="C",V2$=STR(C[6]),V3$=M1$,V0=7,V1=59,V2=16,V4$="Enter Credit Limit or Zero for None"
8740 GOSUB 7000
8750 LET C[6]=V
8790 GOTO 3900
8800 REM "SHOW A0$
8810 LET Z5$="----+----1----+----2----+----3----+----4----+----5----+----6----+----7----+----8"
8820 LET Z5=INT(LEN(A0$))
8830 FOR Z=0 TO Z5
8840 PRINT Z5$,'LF',A0$(Z*80+1,80)
8850 INPUT *,
8860 NEXT Z
8890 ESCAPE
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9210 SETERR 9000
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9800 REM " --- Display Parameter record error"
9810 LET LINE_ERR$=LST(PGM(TCB(5)))
9820 CALL "SYC.YA",LINE_ERR$,N2$,ERR
9900 REM "END
9910 CLOSE (ARM01_DEV,ERR=9911); LET X$=STBL("!CLEAR","ARM01_DEV",ERR=9911)
9920 CLOSE (ARM02_DEV,ERR=9921); LET X$=STBL("!CLEAR","ARM02_DEV",ERR=9921)
9930 CLOSE (ARM04_DEV,ERR=9931); LET X$=STBL("!CLEAR","ARM04_DEV",ERR=9931)
9940 CLOSE (ARM10_DEV,ERR=9941); LET X$=STBL("!CLEAR","ARM10_DEV",ERR=9941)
9950 CLOSE (SYS01_DEV,ERR=9951); LET X$=STBL("!CLEAR","SYS01_DEV",ERR=9951)
9960 REM LET NAME$=CGV("WINDOW_NAME",ERR=09100)
9970 LET X$=STBL("!CLEAR","WINDOW_NAME",ERR=9971)
9980 CALL "SYC.WD",NAME$
9998 EXIT 
9999 END
16000 REM " --- Auto Number"
16010 LET C9=1,Y0$=N0$+"N"
16020 EXTRACT (ARS10_DEV,KEY=Y0$,DOM=16030)IOL=ARS10N
16030 LET I=Y[0]
16040 DIM MAXNUM$(P[0],"9")
16050 LET V$=STR(I:J0$(1,P[0]))
16052 LET V$=V$+J0$,V$=V$(1,6)
16055 LET I=I+1
16060 IF I<=NUM(MAXNUM$) THEN GOTO 16070
16061 DIM MESSAGE$[1]
16062 LET MESSAGE$[0]="There Are No More Numbers Available (<Enter>=Continue)"
16066 CALL "SYC.XA",2,MESSAGE$[ALL],0,22,-1,V$,V3
16067 READ (ARS10_DEV); REM "Unextract the Record"
16068 EXITTO 9900
16070 LET Y[0]=I
16075 FIND (ARM01_DEV,KEY=N0$+V$,DOM=16080); GOTO 16030
16080 WRITE (ARS10_DEV,KEY=N0$+"N")IOL=ARS10N
16090 PRINT @(15,3),FNF$(V$(1,P[0]),M0$),
16099 RETURN 
46500 END
