0010 REM "APM - Name & Address Information"
0020 REM "Program APM.MB"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.2 - 01Jan96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0031 REM "27Aug96 WGH: Error 13 in Line 4740 when deleting a vendor (4740)"
0032 REM "11Feb97 JAL: Don't allow delete when assigned to inventory item (4201,4203,6200-6290)"
0040 REM 
0045 SETESC 9000
0050 SETERR 9000
0060 IF O5=1 THEN GOTO 4200
0200 REM " --- IOLists
0210 APM01A: IOLIST A0$(1),A1$(1)
0220 APM02A: IOLIST X0$,X1$,X2$,X0,X1
0240 APM04A: IOLIST KEY4$
0250 APM04B: IOLIST KEY4$
0700 REM " --- Background
0710 GOSUB 6000
0900 REM " --- Init File
1000 REM " --- Remove X-ref
1005 EXTRACT (APM01_DEV,KEY=A0$(1,K9),DOM=1006)IOL=APM01A
1010 GOSUB 5000
1020 REMOVE (APM04_DEV,KEY=N0$+"A"+A1$(146,10)+A0$(3,6),DOM=1030)
1040 REMOVE (APM04_DEV,KEY=N0$+"B"+A1$(103,9)+A0$(3,6),DOM=1050)
2000 REM " --- Name
2020 LET V0$="S",V1$="C",V2$=A1$(1,30),V3$="",V0=30,V1=15,V2=4,I0=0
2030 LET V4$="Enter The Name Of This Vendor"
2040 GOSUB 7000
2060 LET A1$(1,30)=V$
2070 IF POS(" "<>A1$(146,10))=0 THEN LET A1$(146,10)=A1$(1,10)
2090 GOTO 3900
2100 REM " --- Address
2110 LET X=I0-1
2120 LET V0$="S",V1$="C",V2$=A1$(X*24+31,24),V0=24,V1=15,V2=X+5
2125 LET V4$="Enter Address Line "+STR(X+1)
2130 GOSUB 7000
2140 LET A1$(X*24+31,24)=V$
2190 GOTO 3900
2300 REM " --- Zip Code
2320 LET V0$="S",V1$="",V2$=A1$(103,P[2]),V3$="",V4$="",V0=P[2],V1=15,V2=8
2340 GOSUB 7000
2350 IF LEN(V$)<9 THEN LET V$=V$+J1$(9-LEN(V$))
2360 LET A1$(103,9)=V$
2370 PRINT @(V1,V2),FNZ$(A1$(103))
2390 GOTO 3900
2400 REM " --- Phone
2420 LET V0$="H",V1$="",V2$=A1$(112,10),V3$=M8$,V0=10,V1=15,V2=9
2440 GOSUB 7000
2460 LET A1$(112,10)=V$
2490 GOTO 3900
2500 REM " --- Ext
2520 LET V0$="Z",V1$="",V2$=A1$(122,4),V0=4,V1=35,V2=9
2540 GOSUB 7000
2560 LET A1$(122,4)=V$
2590 GOTO 3900
2600 REM " --- Contact
2620 LET V0$="S",V1$="",V2$=A1$(126,20),V0=20,V1=55,V2=5
2640 GOSUB 7000
2660 LET A1$(126,20)=V$
2690 GOTO 3900
2700 REM " --- Alt Sort
2710 LET V0$="S",V1$="C",V2$=A1$(146,10),V0=10,V1=55,V2=6
2720 LET V4$="Enter The Alternate Sequence (<F1>=Last Name)"
2740 GOSUB 7000
2750 IF V3=1 THEN CALL "SYC.NA",A1$(1,30),V$
2760 LET A1$(146,10)=V$
2770 PRINT @(V1,V2),A1$(146,10),
2790 GOTO 3900
2800 REM " --- Date Open
2820 LET V0$="D",V1$="",V2$=A1$(156,3),V0=8,V1=55,V2=7
2840 GOSUB 7000
2860 LET A1$(156,3)=V$
2890 GOTO 3900
2900 REM " --- Hold
2920 LET V0$="Y",V1$="RC",V2$=A1$(159,1),V4$="Y=Yes N=No",V0=1,V1=55,V2=8
2940 GOSUB 7000
2960 LET A1$(159,1)=V$
2990 GOTO 3900
3000 REM " --- ID #
3020 LET V0$="S",V2$=A1$(160,15),V0=15,V1=55,V2=9
3040 GOSUB 7000
3060 LET A1$(160,15)=V$
3090 GOTO 3900
3100 REM " --- Print 1099?
3120 LET V0$="Y",V1$="RC",V2$=A1$(175,1),V4$="Y=Yes N=No",V0=1,V1=77,V2=9
3140 GOSUB 7000
3160 LET A1$(175,1)=V$
3190 GOTO 3900
3200 REM " --- Account Number
3220 LET V0$="S",V1$="C",V2$=A1$(176,10),V4$="Enter Account Number Assigned By This Vendor",V0=10,V1=55,V2=4
3240 GOSUB 7000
3260 LET A1$(176,10)=V$
3290 GOTO 3900
3300 REM "FAX NUMBER
3320 LET V0$="H",V1$="",V2$=A1$(186,10),V3$=M8$,V0=10,V1=55,V2=3
3340 GOSUB 7000
3360 LET A1$(186,10)=V$
3390 GOTO 3900
3900 REM " --- Next Field
3905 IF V3=4 THEN GOTO 4000
3910 IF V3<>2 THEN GOTO 3940
3920 IF I0>0 THEN LET I0=I0-1
3930 GOTO 3950
3940 LET I0=I0+1
3950 IF ABS(I0)>1000 THEN GOTO 3990
3960 ON I0 GOTO 2000,2100,2100,2100,2300,2400,2500,3300,3200,2600,2700,2800,2900,3000,3100,3990
4000 REM " --- Options
4010 LET V0$="S",V1$="KC",V2$="Y",V3$="",V4$="Is The Above Information Correct (Y/N/##/Restore/Delete)?",V0=7,V1=FNV(V4$),V2=22
4020 GOSUB 7000
4024 LET I=INT(NUM(V$,ERR=4030))
4026 IF I>0 THEN LET I0=I-2; GOTO 3900
4030 IF V$="DELETE" THEN GOTO 4200
4040 IF V$="R" OR V$="RESTORE" THEN GOTO 4800
4050 ON POS(V$="YN") GOTO 4000,4100,2000
4100 REM " --- Write
4120 WRITE (APM01_DEV,KEY=A0$(1,K9))IOL=APM01A
4130 LET KEY4$=N0$+"A"+A1$(146,10)+A0$(3,6)
4140 WRITE (APM04_DEV,KEY=KEY4$)IOL=APM04A
4150 LET KEY4$=N0$+"B"+A1$(103,9)+A0$(3,6)
4160 WRITE (APM04_DEV,KEY=KEY4$)IOL=APM04B
4170 LET O9=0
4180 IF O8=0 THEN RUN "APM.MC"
4190 RUN "APM.MA"
4200 REM " --- Delete
4201 GOSUB 6200
4203 IF STATUS THEN GOTO 4300
4205 LET X2=0
4210 READ (APM02_DEV,KEY=A0$(1,8),DOM=4220)
4220 LET K$=KEY(APM02_DEV,END=4270)
4230 IF K$(1,8)<>A0$(1,8) THEN GOTO 4270
4240 READ (APM02_DEV)IOL=APM02A
4250 IF X0<>0 OR X1<>0 THEN GOTO 4300
4255 GOSUB 4500
4260 GOTO 4220
4270 IF X2<>0 THEN GOTO 4300
4275 REMOVE (APM01_DEV,KEY=A0$(1,K9),DOM=4280)
4280 LET O0=2
4283 GOSUB 6100
4285 GOSUB 4700
4290 RUN "APM.MA"
4300 REM " --- Active
4310 PRINT 'RB',
4320 LET V0$="S",V1$="C",V2$="",V3$="",V4$="I'm Sorry But This Vendor Is Active <Enter> ",V0=1,V1=FNV(V4$),V2=22
4330 GOSUB 7000
4390 GOTO 4000
4500 REM " --- Check APT-01
4510 READ (APT01_DEV,KEY=N0$+X0$(9,2)+X0$(3,6),DOM=4520)
4520 LET K$=KEY(APT01_DEV,END=4550)
4530 IF K$(1,10)<>N0$+X0$(9,2)+X0$(3,6) THEN GOTO 4550
4540 LET X2=X2+1
4550 REM " --- Check APE-01
4560 READ (APE01_DEV,KEY=N0$+X0$(9,2)+X0$(3,6),DOM=4570)
4570 LET K$=KEY(APE01_DEV,END=4595)
4580 IF K$(1,10)<>N0$+X0$(9,2)+X0$(3,6) THEN GOTO 4595
4590 LET X2=X2+1
4595 RETURN 
4700 REM " --- Delete from APM-02"
4710 READ (APM02_DEV,KEY=A0$(1,8),DOM=4720)
4720 LET K$=KEY(APM02_DEV,END=4790)
4730 IF K$(1,8)<>A0$(1,8) THEN GOTO 4790
4740 REMOVE (APM02_DEV,KEY=K$)
4750 GOTO 4710
4790 RETURN 
4800 REM " --- Restore
4820 FIND (APM01_DEV,KEY=A0$(1,K9),DOM=4010)IOL=APM01A
4830 LET O0=3
4850 GOTO 4130
6000 REM " --- Clear Screen
6020 PRINT @(0,L0),'CE'
6090 RETURN 
6100 REM " --- Delete Vendor Comments (APM-09)
6110 READ (APM09_DEV,KEY=A0$(1,8),DOM=6120)
6120 LET K12$=KEY(APM09_DEV,END=6195)
6130 IF K12$(1,8)<>A0$(1,8) THEN GOTO 6195
6140 REMOVE (APM09_DEV,KEY=K12$)
6150 GOTO 6120
6195 RETURN 
6200 REM " --- Is vendor assigned to any inventory items?"
6210 LET STATUS=0
6220 IF IV$<>"Y" THEN GOTO 6290
6230 READ (IVM03_DEV,KEY=N0$+"D"+A0$(3),DOM=6240)
6240 LET K$=KEY(IVM03_DEV,END=6290)
6250 IF POS(A0$(3)=K$(4)) THEN LET STATUS=1
6290 RETURN 
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM " --- Functions
8085 DEF FNZ$(Q$)=FILL(10,CVS(Q$(1,3)+FILL(POS("9"<Q$(1,5))>0)+Q$(4,2)+FILL(ABS(POS("A">=Q$(1,6))>0)-POS("0">Q$(6,4))>0,"-")+Q$(6,4)+FILL(10),16))
8095 DEF FNV(Q$)=42+INT(LEN(Q$)/2)
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9210 SETERR 9000
9220 RUN "APM.MA"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 RUN "SYS.AA"
9999 END
