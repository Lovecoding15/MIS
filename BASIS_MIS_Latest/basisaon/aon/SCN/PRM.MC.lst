0010 REM "PRM - Employee Maintenance - Employee Info 2
0020 REM "Program PRM.MC"
0022 REM "+-----------------------------------------------------------+"
0024 REM "| ADD+ON Software, Inc. Advantage/V Version 6.0.0 - 15May96 |"
0026 REM "|      Copyright (c) 1996 Open Systems Holdings Corp.       |"
0028 REM "|                  All Rights Reserved                      |"
0030 REM "+-----------------------------------------------------------+"
0031 REM "07Apr99 WGH: Un-politically-correct racial designation (1525)
0040 REM 
0085 SETESC 9000
0090 SETERR 9000
0200 REM " --- IOLists
0220 PRM10E: IOLIST X0$
0230 PRM10F: IOLIST X0$
0240 PRM10J: IOLIST X$(1)
0800 REM " --- Display
0900 IF I0>8 THEN LET I0=I0-8; GOTO 3900
1000 REM " --- Emerg Contact
1020 LET V0$="S",V2$=A1$(176,24),V0=24,V1=15,V2=14,I0=0
1040 GOSUB 7000
1060 LET A1$(176,24)=V$
1090 GOTO 3900
1100 REM " --- Relation
1120 LET V0$="S",V2$=A1$(200,10),V0=10,V1=15,V2=15
1140 GOSUB 7000
1160 LET A1$(200,10)=V$
1190 GOTO 3900
1200 REM " --- Emerg Phone
1220 LET V0$="H",V2$=A1$(210,10),V3$=M8$,V0=10,V1=15,V2=16
1240 GOSUB 7000
1260 LET A1$(210,10)=V$
1290 GOTO 3900
1300 REM " --- Alt Seq
1310 IF A1$(145,10)=FILL(10) THEN LET A1$(145,10)=A1$(1,POS(" "<>A1$(1,16),-1))+", "+A1$(17,14)
1320 LET V0$="S",V2$=A1$(145,10),V0=10,V1=55,V2=6
1340 GOSUB 7000
1360 LET A1$(145,10)=V$
1390 GOTO 3900
1400 REM " --- Sex
1420 LET V0$="S",V1$="C",V2$=A1$(155,1),V3$=" MF",V4$="M=Male  F=Female",V0=1,V1=55,V2=7
1440 GOSUB 7000
1460 LET A1$(155,1)=V$
1490 GOTO 3900
1500 REM " --- Race
1520 LET V0$="S",V2$=A1$(156,1),V3$=" ACHNO",V0=1,V1=55,V2=8
1525 LET V4$="A=African American  C=Caucasian  H=Hispanic  N=Native American  O=Asian"
1540 GOSUB 7000
1560 LET A1$(156,1)=V$
1590 GOTO 3900
1600 REM " --- M/S
1620 LET V0$="S",V1$="C",V2$=A1$(157,1),V3$=" SMWD",V4$="S=Single  M=Married  W=Widowed  D=Divorced",V0=1,V1=55,V2=9
1640 GOSUB 7000
1660 LET A1$(157,1)=V$
1690 GOTO 3900
1700 REM " --- Dates
1710 LET X=I0-9
1720 LET V0$="D",V1$="R",V2$=A1$(158+3*X,3),V4$=" ",V0=8,V1=55,V2=10+X
1730 GOSUB 7000
1740 IF V3=4 THEN GOTO 3900
1780 LET A1$(158+3*X,3)=V$
1790 GOTO 3900
2000 REM " --- Normal Pay
2020 LET V0$="S",V1$="R",V2$=A1$(220,1),V3$="DWBSMQA",V4$=V3$,V0=1,V1=55,V2=16
2025 LET V4$="D=Daily, W=Weekly, B=Biwkly, S=Semimnthly, M=Monthly, Q=Quarterly, A=Annually"
2040 GOSUB 7000
2060 LET A1$(220,1)=V$
2090 GOTO 3900
2100 REM " --- Normal Dept
2120 LET V0$="S",V1$="KCR",V2$=A1$(221,2),V4$="Enter Normal Department (<F3>=Lookup)",V0=2,V1=55,V2=17
2130 GOSUB 7000
2131 IF V3=4 THEN GOTO 3900
2132 IF V3<>3 THEN GOTO 2140
2134 LET V4=1,V6=4,V7=2,V8=6,V9=20,V5$="E"
2136 CALL "SYC.LZ",V1,V2,V4,PRM10_DEV,V6,V7,V8,V9,V$,V5$,N0$
2138 IF V$="" THEN GOTO 2100
2140 LET A1$(221,2)=V$
2150 FIND (PRM10_DEV,KEY=N0$+"E"+A1$(221,2),DOM=2100)IOL=PRM10E
2160 PRINT @(V1+3,V2),X0$(6,20),
2190 GOTO 3900
2200 REM " --- Normal Title
2220 LET V0$="S",V1$="KC",V2$=A1$(223,2),V0=2,V1=55,V2=18,V4$="Enter Normal Title (<F3>=Lookup)"
2230 GOSUB 7000
2231 IF V3=4 THEN GOTO 3900
2232 IF V3<>3 THEN GOTO 2240
2234 LET V4=1,V6=4,V7=2,V8=6,V9=20,V5$="F"
2236 CALL "SYC.LZ",V1,V2,V4,PRM10_DEV,V6,V7,V8,V9,V$,V5$,N0$
2238 IF V$="" THEN GOTO 2200
2240 LET A1$(223,2)=V$
2250 FIND (PRM10_DEV,KEY=N0$+"F"+A1$(223,2),DOM=2200)IOL=PRM10F
2260 PRINT @(V1+3,V2),X0$(6,20),
2290 GOTO 3900
2300 REM " --- Hourly/Salaried
2320 LET V0$="S",V1$="RC",V2$=A1$(225,1),V3$="HS",V4$="H=Hourly  S=Salaried",V0=1,V1=55,V2=19
2340 GOSUB 7000
2360 LET A1$(225,1)=V$
2390 GOTO 3900
2400 REM " --- Pension
2420 LET V0$="Y",V1$="RC",V2$=A1$(226,1),V0=1,V1=55,V2=20,V3$="YN",V4$="Y=Yes  N=No"
2440 GOSUB 7000
2460 LET A1$(226,1)=V$
2490 GOTO 3900
2500 REM " --- Memo
2520 LET V0$="S",V2$=A1$(227,10),V0=10,V1=15,V2=17
2540 GOSUB 7000
2560 LET A1$(227,10)=V$
2590 GOTO 3900
2600 REM " --- Full/Part
2620 LET V0$="S",V1$="RC",V2$=A1$(237,1),V3$="FP",V4$="F=Full-Time  P=Part-Time",V0=1,V1=55,V2=21
2640 GOSUB 7000
2660 LET A1$(237,1)=V$
2690 GOTO 3900
3000 REM " --- Union Code
3010 IF P3$(9,1)<>"Y" THEN GOTO 3090
3020 LET V0$="S",V1$="C",V2$=A1$(238,3),V4$="Enter Valid Union Code Or Press <F3> For Lookup",V0=3,V1=15,V2=18
3030 GOSUB 7000
3035 IF V3<>3 THEN GOTO 3060
3040 LET V4=1,V6=4,V7=3,V8=7,V9=30,V5$="J"
3045 CALL "SYC.LZ",V1,V2,V4,PRM10_DEV,V6,V7,V8,V9,V$,V5$,N0$
3050 IF V$="" THEN GOTO 3000
3060 LET A1$(238,3)=V$
3070 DIM X$(40)
3075 FIND (PRM10_DEV,KEY=N0$+"J"+A1$(238,3),DOM=3000)IOL=PRM10J
3080 PRINT @(V1+V0+1,V2),X$(7,20),@(V1+V0+1,V2+1),X$(27,10),
3090 GOTO 3900
3900 REM " --- Next Field
3910 IF V3=4 THEN GOTO 3990
3920 IF V3<>2 THEN GOTO 3950
3925 IF I0=0 THEN GOTO 4200
3930 IF I0>0 THEN LET I0=I0-1
3940 GOTO 3960
3950 LET I0=I0+1
3960 ON I0 GOTO 1000,1100,1200,2500,3000,1300,1400,1500,1600,1700,1700,1700,1700,2000,2100,2200,2300,2400,2600,4000
4000 REM " --- Overlay
4020 LET O9=1
4040 RUN "PRM.MB"
4200 REM " --- Backup
4220 LET O9=2
4240 RUN "PRM.MB"
7000 REM " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7200
7030 IF V3=127 THEN GOTO 7100
7090 RETURN 
7100 REM " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7200,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7200 REM " --- Error During Input"
7210 ESCAPE
7290 GOTO 7000
8000 REM " --- Functions
9000 REM " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9100
9040 IF E1=3 THEN GOTO 9200
9080 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9090 ESCAPE
9100 REM " --- Retry"
9190 RETRY
9200 REM " --- Return"
9210 SETERR 9000
9220 RUN "PRM.MA"
9290 GOTO 9900
9300 REM " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9390
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9350 ESCAPE
9390 RETURN 
9900 RUN "SYS.AA"
9999 END
