0010 REM BLK.08
0020 BEGIN 
0030 SETERR 9000
0040 SETESC 9000
0050 LET SYS01T=UNT; OPEN (SYS01T)"SYS-01"
0060 LET TERMINAL$="T"+FID(0)
0070 READ (SYS01T,KEY=TERMINAL$)*,F0$; CLOSE (SYS01T)
0080 LET ARE03=UNT; OPEN (ARE03)"ARE-03"
0090 PRINT @(0,3),'CE'
0100 PRINT 'SB',@(20,3),"Beginning Order:",@(23,5),"Ending Order:",
0110 PRINT 'SB',@(18,7),"Beginning Invoice:",@(21,9),"Ending Invoice:",
0120 PRINT 'SB',@(18,11),"Beginning Serial#:",@(21,13),"Ending Serial#:"
0130 PRINT 'SB',@(12,15),"Print/Email/Fax (P/E/F):",'SF',
0140 START_ORD: 
0150 FOR I=3 TO 15 STEP 2
0160 PRINT @(40,I),FILL(9),; NEXT I
0170 LET M0$="0000000",START_INUM$="",END_INUM$=""
0180 LET V0$="M",V1$="CE",V2$=M0$,V3$=M0$,V4$="",V0=7,V1=40,V2=3,I0=0
0190 GOSUB 7000
0200 IF V3=4 THEN GOTO 9900
0210 LET V$=V$+M0$,V$=V$(1,7)
0220 IF V$=M0$ THEN GOTO START_INV
0230 GOSUB GET_ORD; IF FOUND=0 THEN GOTO START_ORD
0240 PRINT @(V1,V2),V$(1,7); LET START_ONUM$=V$
0250 END_ORD: 
0260 LET V0$="M",V1$="CE",V2$=V$,V3$=M0$,V4$="",V0=7,V1=40,V2=5,I0=0
0270 GOSUB 7000; IF V3=4 THEN GOTO 9900
0280 LET V$=V$+M0$,V$=V$(1,7); IF V$<START_ONUM$ THEN GOTO END_ORD
0290 IF V$<>START_ONUM$ AND V$<>"9999999" THEN GOSUB GET_ORD; IF FOUND=0 THEN GOTO END_ORD
0300 PRINT @(V1,V2),V$(1,7); LET END_ONUM$=V$; GOTO START_SN
0310 START_INV: LET M0$="0000000",START_ONUM$="",END_ONUM$=""
0320 LET V0$="M",V1$="CE",V2$=M0$,V3$=M0$,V4$="",V0=7,V1=40,V2=7,I0=0
0330 GOSUB 7000
0340 IF V3=4 THEN GOTO 9900
0350 LET V$=V$+M0$,V$=V$(1,7)
0360 PRINT @(V1,V2),V$(1,7); LET START_INUM$=V$
0370 IF V$=M0$ THEN LET V$=FILL(7,"9")
0380 END_INV: 
0390 LET V0$="M",V1$="CE",V2$=V$,V3$=M0$,V4$="",V0=7,V1=40,V2=9,I0=0
0400 GOSUB 7000; IF V3=4 THEN GOTO 9900
0410 LET V$=V$+M0$,V$=V$(1,7); IF V$<START_INUM$ THEN GOTO END_INV
0420 PRINT @(V1,V2),V$(1,7); LET END_INUM$=V$
0430 START_SN: 
0440 LET V0$="S",V1$="CE^",V2$="",V3$="",V4$="",V0=9,V1=40,V2=11,I0=0
0450 GOSUB 7000; IF V3=4 THEN GOTO 9900
0460 LET V$=V$+FILL(V0); LET V$=V$(1,V0)
0470 IF V$=FILL(V0) THEN LET START_SNUM$="",END_SNUM$=""; GOTO CHOOSE
0480 PRINT @(V1,V2),V$; LET START_SNUM$=V$
0490 END_SN: 
0500 LET V0$="S",V1$="CE^",V2$=V$,V3$="",V4$="",V0=9,V1=40,V2=13,I0=0
0510 GOSUB 7000; IF V3=4 THEN GOTO 9900
0520 LET V$=V$+FILL(V0); LET V$=V$(1,V0)
0530 IF V$=FILL(V0) THEN LET V$=START_SNUM$
0540 IF V$<START_SNUM$ THEN GOTO END_SN
0550 PRINT @(V1,V2),V$(1,7); LET END_SNUM$=V$
0560 CHOOSE: 
0570 LET V0$="S",V1$="CE^",V2$="E",V3$="",V4$="",V0=1,V1=40,V2=15,I0=0
0580 GOSUB 7000; IF V3=4 THEN GOTO 9900
0590 IF POS(V$="PEF")=0 OR LEN(V$)<>1 THEN GOTO CHOOSE
0600 PRINT @(V1,V2),V$; LET CHOICE$=V$
0610 REM " --- Correct "
0620 LET V4$="Is The Above Information Correct",V0=1,V1=42+INT(LEN(V4$)/2),V2=22
0630 CALL "SYC.YN",1,V4$,2,V$,V3
0632 IF V3=4 THEN GOTO 9900
0635 rem ' print @(10,22),'CL',"Is The Above Information Correct? (Y/N/Q CR=Y)  ",; input @(58,22),v$
0636 rem ' if v$ = "" then v$="Y"
0640 rem ' IF CTL=4 THEN GOTO 9900
0645 rem ' if cvs(V$,4) = "Q" then goto 9900
0650 ON POS(CVS(V$,4)="YN") GOTO 0560,0660,0140
0660 CLOSE (ARE03)
0670 RUN "BLK.10"
0680 GET_ORD: LET FOUND=0; READ (ARE03,KEY=F0$(16,2),DOM=READARE03)
0690 READARE03: READ (ARE03,END=END_GET_ORD)ARE03$; IF ARE03$(1,2)<>F0$(16,2) THEN GOTO END_GET_ORD
0700 IF ARE03$(11,7)<>V$ THEN GOTO READARE03 ELSE LET FOUND=1
0710 END_GET_ORD: RETURN 
7000 REM 7000 " --- Standard Input Routine (15May95)"
7010 CALL "SYC.IA",V0$,V1$,V2$,V3$,V4$,PGM(-2),V0,V1,V2,V$,V,V3,DISPLAY_LEN
7020 IF V3=999 THEN GOTO 7140
7030 IF V3=127 THEN GOTO 7100
7040 RETURN 
7100 REM 7100 " --- Escape During Input"
7110 CALL "SYC.ES",ERR=7140,PGM(-2),TCB(8),E$,E2,V3
7120 IF V3<>127 THEN GOTO 7000
7130 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
7140 REM " --- Error During Input"
7150 ESCAPE
7160 GOTO 7000
9000 REM 9000 " --- Standard Error Routine (15May95)"
9010 IF ERR=127 THEN GOTO 9300
9020 CALL "SYC.EA",ERR=9060,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
9030 IF E1=1 THEN GOTO 9070
9040 IF E1=3 THEN GOTO 9090
9050 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9060 ESCAPE
9070 REM " --- Retry"
9080 RETRY
9090 REM " --- Return"
9100 SETERR 9000
9110 GOTO 9900
9300 REM 9300 " --- Standard Escape Routine"
9310 CALL "SYC.ES",ERR=9340,PGM(-2),TCB(8),E$,E2,V3
9320 IF V3<>127 THEN GOTO 9350
9330 PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
9340 ESCAPE
9350 RETURN 
9800 REM 9800 " --- Display Parameter record error"
9810 LET LINE_ERR$=LST(PGM(TCB(5)))
9820 CALL "SYC.YA",LINE_ERR$,N2$,ERR
9900 REM 9900
9910 RUN "SYS.AA"
9920 END
