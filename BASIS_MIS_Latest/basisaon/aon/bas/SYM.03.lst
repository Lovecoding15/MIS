seterr err_routine
setesc err_routine

enter

PRINT 'WINDOW'(20,8,40,5,""),'CURSOR'("ON"),
PRINT 'CS',@(2,0),"Euro to Dollar Conversion"
i$="Y"
PRINT @(2,2),"OK to Continue (Y/N)? ",I$,
INPUTE 24,2,1,"",I$
if cvs(i$,3)<>"Y" then goto eoj

lf$=$0a$
filelist$="APE01"+lf$+"APE02"+lf$+"APE03"+lf$+"APE04"+lf$+"APE05"+lf$+
: "APE11"+lf$+"APE12"+lf$+"APE13"+lf$+"APE22"+lf$+"APM02"+lf$+"APT01"+
: lf$+"APT02"+lf$+"APT11"+lf$+"ARE01"+lf$+"ARE02"+lf$+"ARE03"+lf$+
: "ARE11"+lf$+"ARE13"+lf$+"ARE15"+lf$+"ARE20"+lf$+"ARE21"+lf$+"ARE31"+
: lf$+"ARM02"+lf$+"ARM06"+lf$+"ARS10C"+lf$+"ARS10S"+lf$+"ART01"+lf$+
: "ART02"+lf$+"ART03"+lf$+"ART06"+lf$+"ART07"+lf$+"ART11"+lf$+"ART13"+
: lf$+"ART16"+lf$+"ART26"+lf$+"GLE06"+lf$+"GLE07"+lf$+"GLE08"+lf$+"GLE09"+
: lf$+"GLE11"+lf$+"GLM02"+lf$+"GLT04"+lf$+"GLT06"+lf$+"SYS01X"+lf$

firm$="02"
firm_out$="03"
path$=STBL("DATA_SERVER")+"/basisaon/aon/ADATA/"
module$="ARM,ARS,GLM,GLT,SYS"

filename$="SYS01X"
gosub template_open
a.record_id$="X",a.available$=fill(99)
read record (xf,key=a.record_id$,DOM=*NEXT)a$
close(xf)
dim exchg_rate[1]
exchg_rate[0]=a.exch_rate
decimals=a.precision
exchg_rate[1]=a.exch_rate1
rem 'Dollar=euro/exchg_rate

dim sym03$:"filename:C(6*),filler1:C(36),filetype:C(1),filler2:C(40*),filler3:C(30*),num1:N(2*),num2:N(5*),num3:N(7*)"
xf$="SYM-03"
gosub file_open
sym03=xf
process_file$=""
rec_id$="ARS10C*C"+lf$+"ARS10S*S"+lf$
skip_file$="GLM-21"
print 'cs'

sym03_loop:
readrecord (sym03,end=sym03_end)sym03$
let xf$=cvs(sym03.filename$,3)
if pos(xf$(1,3)=module$)=0 or sym03.filetype$<>"M" 
:  or pos(xf$=skip_file$) then goto sym03_loop
process_file$=process_file$+xf$+lf$
goto sym03_loop
sym03_end:
process_file$=process_file$+rec_id$

main_loop:
temp=pos(lf$=process_file$)
if temp=0 then goto eoj
xf$=process_file$(1,temp-1),process_file$=process_file$(temp+1)
temp=pos("*"=xf$),rectype$=""
if temp then rectype$=xf$(temp+1),xf$=xf$(1,temp-1)
temp=pos("-"=xf$),filename$=xf$
if temp then filename$=xf$(1,temp-1)+xf$(temp+1)
print @(8,1),"Working on ",xf$              

close(xf,err=*NEXT)
convert=pos(filename$+lf$=filelist$)
if convert then gosub template_open else gosub file_open
x$=fid(xf)
if pos(xf$=x$(9))=0 then print x$(9);print xf$;escape
w$=fid(wf)
if x$<>w$ then print w$(9);print xf$;escape

rem 'clear existing data from firm_out
read(wf,key=firm_out$,dom=remove_loop)
remove_loop:
krmv$=key(wf,end=remove_loop_end)
if pos(firm_out$=krmv$)<>1 then goto remove_loop_end
remove(wf,key=krmv$)
goto remove_loop
remove_loop_end:

Read (xf,key=firm$,dom=copy_loop)
copy_loop:
k$=key(xf,end=main_loop)
if k$(1,2)<>firm$ then goto main_loop

if convert then goto convert_currency

readrecord(xf,key=k$)f$
kw$=firm_out$+k$(3),f$(1,2)=firm_out$
writerecord(wf,key=kw$)f$
goto copy_loop

convert_currency:
fld$=fattr(a$,"")
moneyfld$=""
actfld$=""
fields:
p=pos(lf$=fld$)
if p=0 then goto fields_done
fldname$=fld$(1,p-1), fld$=fld$(p+1), money=0
money=num(fattr(a$,fldname$,"MON"),err=*next)
if money then moneyfld$=moneyfld$+fldname$+lf$
if actfld$<>"" then goto fields
rem "only 1 account field per record type
acct=num(fattr(a$,fldname$,"ACT"),err=fields)
if acct then actfld$=fldname$
goto fields
fields_done:

ctr=0
read(xf,key=firm$,dom=convert_rec)
convert_rec:
xk$=key(xf,end=main_loop)
readrecord(xf,key=xk$)a$

if a.firm_id$ <> firm$ then goto main_loop
if rectype$<>"" and pos(rectype$=a$)<>3 then goto convert_rec
modified=0,fld$=moneyfld$
account$=""
xrate=0
if actfld$<>"" then 
  account$=field(a$,actfld$)
  acct=num(account$,err=moneyfields)
  if acct<4000000000 then xrate=1
fi

moneyfields:
p=pos(lf$=fld$)
if p=0 then goto moneyfields_done
fldname$=fld$(1,p-1), fld$=fld$(p+1)

euro=nfield(a$,fldname$)
if euro=0 then goto moneyfields

precision decimals
dollars=euro/exchg_rate[xrate]

precision 2
dollars=dollars*1
field a$,fldname$=dollars

modified=1
goto moneyfields

moneyfields_done:
ctr=ctr+1
wk$=firm_out$+xk$(3),a.firm_id$=firm_out$
a$=field(a$)
writerecord(wf,key=wk$)a$
goto convert_rec

template_open:
temp=pos(filename$+lf$=filelist$)
if temp=0 then exitto file_err
lf=pos(lf$=filelist$(1,temp),1,0)
rem 'filelist must correspond to the following goto list

on lf goto APE01,APE02,APE03,APE04,APE05,APE11,APE12,APE13,APE22,APM02,APT01,APT02,APT11,ARE01,ARE02,ARE03,ARE11,ARE13,ARE15,ARE20,ARE21,ARE31,ARM02,ARM06,ARS10C,ARS10S,ART01,ART02,ART03,ART06,ART07,ART11,ART13,ART16,ART26,GLE06,GLE07,GLE08,GLE09,GLE11,GLM02,GLT04,GLT06,SYS01X

APE01: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),AP_INV_NBR:C(10),SEQUENCE_00:C(2),DIST_CODE:C(2),PAYMENT_GRP:C(2),TERMS_CODE:C(2),INVOICE_DATE:C(3),ACCTING_DATE:C(3),DUE_DATE:C(3),DISC_DATE:C(3),AP_REFERENCE:C(10),AP_INV_MEMO:C(16),AP_HOLD_FLAG:C(1),INV_CREDIT:C(1),RESERVED_STR:C(20*),INVOICE_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,RETENTION:N(7*):MON=1:,NET_INV_AMT:N(7*):MON=1:"
LET xf$="APE-01"; goto FILE_OPEN

APE02: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),CHECK_NUMBER:C(7),VENDOR_NBR:C(6),RESERVED_STR:C(10),CHECK_DATE:C(3),AP_CHK_CODE:C(1*),TMP_VEND_NAM:C(30*),CHECK_AMOUNT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,RETENTION:N(7*):MON=1:"
LET xf$="APE-02"; goto FILE_OPEN

APE03: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),INV_NBR:C(6),UNI_INV_MOD:C(4),SEQUENCE_00:C(2),DIST_CODE:C(2),PAYMENT_GRP:C(2),TERMS_CODE:C(2),INVOICE_DATE:C(3),ACCTING_DATE:C(3),DUE_DATE:C(3),DISC_DATE:C(3),AP_REFERENCE:C(10),AP_INV_MEMO:C(16),AP_HOLD_FLAG:C(1),INV_CREDIT:C(1*),INVOICE_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,RETENTION:N(7*):MON=1:"
LET xf$="APE-03"; goto FILE_OPEN

APE04: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),AP_INV_NBR:C(10),INVOICE_DATE:C(3),DUE_DATE:C(3),DISC_DATE:C(3),REFERENCE:C(10),AP_INV_MEMO:C(16),CHECK_NUMBER:C(7*),INVOICE_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,RETENTION:N(7*):MON=1:,ORIG_INV_AMT:N(7*):MON=1:"
LET xf$="APE-04"; goto FILE_OPEN

APE05: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),CHECK_NUMBER:C(7),VENDOR_NBR:C(6),AP_INV_NBR:C(10),CHECK_DATE:C(3),CHECK_TYPE:C(1),DIST_CODE:C(2*),TMP_VEND_NAM:C(30*),INVOICE_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,RETENTION:N(7*):MON=1:"
LET xf$="APE-05"; goto FILE_OPEN

APE11: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),AP_INV_NBR:C(10),AP_INV_LINE:C(2*),gl_account:c(10):ACT=1:,NON_PO_FLAG:C(1*),JOB_NUMBER:C(10*),GL_POST_AMT:N(7*):MON=1:,UNITS:N(7*)"
LET xf$="APE-11"; goto FILE_OPEN

APE12: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),CHECK_NUMBER:C(7),VENDOR_NBR:C(6),AP_INV_NBR:C(10),AP_INV_LINE:C(2*),gl_account:c(10):ACT=1:,NON_PO_FLAG:C(1*),AP_JOB_NBR:C(10*),GL_POST_AMT:N(7*):MON=1:,UNITS:N(7*)"
LET xf$="APE-12"; goto FILE_OPEN

APE13: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),AP_INV_NBR:C(10),AP_INV_LINE:C(2*),GL_ACCOUNT:C(10*):ACT=1:,AP_JOB_NBR:C(10*),GL_POST_AMT:N(7*):MON=1:,UNITS:N(7*)"
LET xf$="APE-13"; goto FILE_OPEN

APE22: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),CHECK_NUMBER:C(7),VENDOR_NBR:C(6),AP_INV_NBR:C(10),SEQUENCE_00:C(2),INVOICE_DATE:C(3),DIST_CODE:C(2),RESERVED_STR:C(10*),INVOICE_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,RETENTION:N(7*):MON=1:"
LET xf$="APE-22"; goto FILE_OPEN

APM02: 
DIM A$:"FIRM_ID:C(2),VENDOR_NBR:C(6),AP_TYPE:C(2*),DIST_CODE:C(2),PAYMENT_GRP:C(2),TERMS_CODE:C(2),LAST_INVD:C(3),LAST_PAYMENT:C(3),RESERVED_STR:C(12*),GL_ACCOUNT:C(10*):ACT=1:,OPEN_INVS:N(7*):MON=1:,OPEN_RET:N(7*):MON=1:,YTD_PURCH:N(7*):MON=1:,PYR_PURCH:N(7*):MON=1:,NYR_PURCH:N(7*):MON=1:,YTD_DISCS:N(7*):MON=1:,PRI_YR_DISCS:N(7*):MON=1:,NYR_DISC:N(7*):MON=1:,YTD_PAYMENTS:N(7*):MON=1:,PYR_PAYMENTS:N(7*):MON=1:,NYR_PAYMENTS:N(7*):MON=1:,CUR_CAL_PMTS:N(7*):MON=1:,PRI_CAL_PMT:N(7*):MON=1:,NXT_CYR_PMTS:N(7*):MON=1:"
LET xf$="APM-02"; goto FILE_OPEN

APT01: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),AP_INV_NBR:C(10),SEQUENCE_00:C(2),DIST_CODE:C(2),PAYMENT_GRP:C(2),TERMS_CODE:C(2),INVOICE_DATE:C(3),ACCTING_DATE:C(3),DUE_DATE:C(3),DISC_DATE:C(3),AP_REFERENCE:C(10),AP_INV_MEMO:C(16),AP_HOLD_FLAG:C(1),MC_INV_FLAG:C(1),MC_INV_ADJ:C(1),MC_INV_REV:C(1),RESERVED_STR:C(1*),INVOICE_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,RETENTION:N(7*):MON=1:"
LET xf$="APT-01"; goto FILE_OPEN

APT02: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),INV_CREDIT:C(1),INV_CHK_NBR:C(10),gl_account:c(10):ACT=1:,ACCTING_DATE:C(3*),GL_POST_AMT:N(7*):MON=1:,UNITS:N(7*)"
LET xf$="APT-02"; goto FILE_OPEN

APT11: 
DIM A$:"FIRM_ID:C(2),AP_TYPE:C(2),VENDOR_NBR:C(6),AP_INV_NBR:C(10),INV_SEQ_NBR:C(2*),AP_TRANS:C(1),TRANS_DATE:C(3),TRANS_REF:C(7*),TRANS_AMT:N(7*):MON=1:,TRANS_DISC:N(7*):MON=1:,TRANS_RET:N(7*):MON=1:"
LET xf$="APT-11"; goto FILE_OPEN

ARE01: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),RESERVED_STR_1:C(1),RECEIPT_DATE:C(3),CUSTOMER_NBR:C(6),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),RESERVED_STR_2:C(1),CASH_OR_CHK:C(1),ABA_NUMBER:C(10),RESERVED_STR_3:C(4*),PAYMENT_AMT:N(7*):MON=1:"
LET xf$="ARE-01"; goto FILE_OPEN

ARE02: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),AR_INV_NBR:C(7),DIST_CODE:C(2),TERMS_CODE:C(2),INVOICE_DATE:C(3),DUE_DATE:C(3),DISC_DATE:C(3),CONV_INV_TYP:C(1),RESERVED_STR:C(14*),INVOICE_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:"
LET xf$="ARE-02"; goto FILE_OPEN

ARE03: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),ORDER_NUMBER:C(7),SEQUENCE_000:C(3),INVOICE_TYPE:C(1),ORD_INV_FLAG:C(1),BACKORD_FLAG:C(1),INVOICE_DATE:C(3),AR_SHIP_DATE:C(3),RESERVED_STR_1:C(2),AR_SHIP_VIA:C(10),AR_INV_NBR:C(7),AR_PO_NUMBER:C(10),SLSPSN_CODE:C(3),TERMS_CODE:C(2),DISC_CODE:C(2),DIST_CODE:C(2),ORD_PRT_FLAG:C(1),ORD_LOCK:C(1),MESSAGE_CODE:C(2),TERRITORY:C(3),LIST_PRC_CDE:C(2),DATE_ORDERED:C(3),TAX_CODE:C(2),PRICING_CODE:C(4),AR_JOB_NBR:C(10),ORD_TAKEN_BY:C(3),CASH_SALE:C(1),REPRINT_FLAG:C(1),ORD_CRED_FLG:C(1),SHIPTO_NBR:C(6),REL_TO_SHIP:C(1),RESERVED_STR_2:C(9*),TAX_AMOUNT:N(7*):MON=1:,FREIGHT_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,COMM_PERCENT:N(7*),TAXABLE_AMT:N(7*):MON=1:,COMM_AMT:N(7*):MON=1:,TOTAL_SALES:N(7*):MON=1:,TOTAL_COST:N(7*):MON=1:,RESERVED_NUM_1:N(1*),RESERVED_NUM_2:N(1*),RESERVED_NUM_3:N(1*)"
LET xf$="ARE-03"; goto FILE_OPEN

ARE11: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),RESERVED_STR_1:C(1),RECEIPT_DATE:C(3),CUSTOMER_NBR:C(6),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),RESERVED_STR_2:C(1),AR_INV_NBR:C(7),RESERVED_STR_3:C(18*),APPLY_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:"
LET xf$="ARE-11"; goto FILE_OPEN

ARE13: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),ORDER_NUMBER:C(7),LINE_NUMBER:C(3),LINE_CODE:C(1),MAN_PRICE:C(1),PRODUCT_TYPE:C(3),PULL_ASSMBLE:C(1),RESERVED_STR_1:C(4),WAREHOUSE_ID:C(2),ITEM_NUMBER:C(20*),ORDER_MEMO:C(40),EST_SHP_DATE:C(3),COMMIT_FLAG:C(1),PICK_FLAG:C(1),RESERVED_STR_2:C(19*),UNIT_COST:N(7*):MON=1:,UNIT_PRICE:N(7*):MON=1:,QTY_ORDERED:N(7*),QTY_BACKORD:N(7*),QTY_SHIPPED:N(7*),STD_LIST_PRC:N(7*):MON=1:,EXT_PRICE:N(7*):MON=1:,TAXABLE_AMT:N(7*):MON=1:,DISC_PERCENT:N(7*),COMM_PERCENT:N(7*),COMM_AMT:N(7*):MON=1:,SPL_COMM_PCT:N(7*),RESERVED_NUM_1:N(1*),RESERVED_NUM_2:N(1*),DISC_CUST:N(7*)"
LET xf$="ARE-13"; goto FILE_OPEN

ARE15: 
DIM A$:"FIRM_ID:C(2),AR_INV_NBR:C(7),LINE_NUMBER:C(3*),gl_account:c(10):ACT=1:,SHIP_DATE:C(6),DESCRIPTION:C(30),RESERVED_STR:C(10*),UNITS:N(7*),UNIT_PRICE:N(7*):MON=1:,EXT_PRICE:N(7*):MON=1:"
LET xf$="ARE-15"; goto FILE_OPEN

ARE20: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),ORDER_NUMBER:C(7),INVOICE_DATE:C(3),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),CC_OR_ABA:C(16),EXPIRE_DATE:C(3),AR_INV_NBR:C(7*),CUST_NAME:C(30*),INVOICE_AMT:N(7*):MON=1:,TENDERED_AMT:N(7*):MON=1:"
LET xf$="ARE-20"; goto FILE_OPEN

ARE21: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),RESERVED_STR_1:C(1),RECEIPT_DATE:C(3),CUSTOMER_NBR:C(6),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),RESERVED_STR_2:C(1),gl_account:c(10):ACT=1:,RESERVED_STR_3:C(15*),GL_POST_AMT:N(7*):MON=1:"
LET xf$="ARE-21"; goto FILE_OPEN

ARE31: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),RESERVED_STR:C(1),CUSTOMER_NBR:C(6),AR_INV_NBR:C(7*),INV_BALANCE:N(7*):MON=1:,RESERVED_NUM:N(1*)"
LET xf$="ARE-31"; goto FILE_OPEN

ARM02: 
DIM A$:"FIRM_ID:C(2),CUSTOMER_NBR:C(6),AR_TYPE:C(2*),SLSPSN_CODE:C(3),TERMS_CODE:C(2),DISC_CODE:C(2),DIST_CODE:C(2),FINANCE_CHG:C(1),SA_FLAG:C(1),FEAT_USER_FLAG:C(1),RESERVED_STR_1:C(1),LASTINV_DATE:C(3),LASTPAY_DATE:C(3),STATEMENTS:C(1),TERRITORY:C(3),PRICING_CODE:C(4),NBR_LABELS:C(2),MESSAGE_CODE:C(2),TAX_CODE:C(2),CUST_TYPE:C(3),INVOICE_PRCD:C(1),INV_HIST_FLG:C(1),CRED_HOLD:C(1),LINK_TO_CUST:C(6),PRODUCT_PREFIX:C(3),RESERVED_STR_3:C(16*),AGING_FUTURE:N(7*):MON=1:,AGING_CUR:N(7*):MON=1:,AGING_30:N(7*):MON=1:,AGING_60:N(7*):MON=1:,AGING_90:N(7*):MON=1:,AGING_120:N(7*):MON=1:,CREDIT_LIMIT:N(7*):MON=1:,PRICING_LEVEL:N(4*),ALLOWED_RESETS:N(2*),RESERVED_NUM_3:N(1*),RESERVED_NUM_4:N(1*)"
LET xf$="ARM-02"; goto FILE_OPEN

ARM06: 
DIM A$:"FIRM_ID:C(2),CUSTOMER_NBR:C(6*),LAST_INV_DATE:C(3),LAST_PAY_DATE:C(3),RESERVED_STR:C(10*),MTD_SALES:N(7*):MON=1:,YTD_SALES:N(7*):MON=1:,PYR_SALES:N(7*):MON=1:,MTD_COST:N(7*):MON=1:,YTD_COST:N(7*):MON=1:,PRI_YTD_COST:N(7*):MON=1:,AVG_DAYS:N(7*),NBR_PAYMENTS:N(7*),NMTD_SALES:N(7*):MON=1:,NXT_MTD_COST:N(7*):MON=1:,AVG_DAYS_MTD:N(7*),MTD_NBR_PMTS:N(7*),AVG_DAYS_YTD:N(7*),YTD_NBR_PMTS:N(7*),AVG_DTP_PYTD:N(7*),PYR_NBR_PY:N(7*),AVG_DTP_NMTD:N(7*),NMTD_NBR_PAY:N(7*),MTD_HIGH_CRD:N(7*):MON=1:,YTD_HI_CRED:N(7*):MON=1:,PYR_HI_CRD:N(7*):MON=1:,NMTD_HIGH_CR:N(7*):MON=1:"
LET xf$="ARM-06"; goto FILE_OPEN

ARS10C: 
DIM A$:"FIRM_ID:C(2),RECORD_ID_C:C(1*=10),MTD_CASH:N(7*=10):MON=1:,MTD_CSH_DISC:N(7*=10):MON=1:,MTD_CSH_GL:N(7*=10):MON=1:,NXT_MTD_CASH:N(7*=10):MON=1:,NMTD_CASH_DS:N(7*=10):MON=1:,NMTD_CASH_GL:N(7*=10):MON=1:,RESERVED_NUM:N(1*=10)"
LET xf$="ARS-10"; goto FILE_OPEN

ARS10S: 
DIM A$:"FIRM_ID:C(2),RECORD_ID_S:C(1*=10),MTD_SALES:N(7*=10):MON=1:,MTD_RETURNS:N(7*=10):MON=1:,MTD_TAX:N(7*=10):MON=1:,MTD_FREIGHT:N(7*=10):MON=1:,MTD_COST:N(7*=10):MON=1:,MTD_DISCOUNT:N(7*=10):MON=1:,MTD_CSH_SALE:N(7*=10):MON=1:,RESERVED_NUM_1:N(1*=10),NMTD_SALES:N(7*=10):MON=1:,NMTD_RETURNS:N(7*=10):MON=1:,NMTD_TAX:N(7*=10):MON=1:,NXT_MTD_FRGT:N(7*=10):MON=1:,NXT_MTD_COST:N(7*=10):MON=1:,NXT_MTD_DISC:N(7*=10):MON=1:,NMTD_CASH_SL:N(7*=10):MON=1:,RESERVED_NUM_2:N(1*=10)"
LET xf$="ARS-10"; goto FILE_OPEN

ART01: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),AR_INV_NBR:C(7),SEQUENCE_00:C(2),DIST_CODE:C(2),TERMS_CODE:C(2),INVOICE_DATE:C(3),DUE_DATE:C(3),DISC_DATE:C(3),AR_INV_TYPE:C(1),RESERVED_STR:C(6),DATES_CHG:C(1),AR_JOB_NBR:C(10*),INVOICE_AMT:N(7*):MON=1:,DISC_ALLOWED:N(7*):MON=1:"
LET xf$="ART-01"; goto FILE_OPEN

ART02: 
DIM A$:"FIRM_ID:C(2),TAX_CODE:C(2),YEAR:C(2),MONTH:C(2*),TAXABLE_AMT:N(7*):MON=1:,TAX_AMOUNT:N(7*):MON=1:,GROSS_SALES:N(10*):MON=1:,RETURNS:N(7*):MON=1:"
LET xf$="ART-02"; goto FILE_OPEN

ART03: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),AR_INV_NBR:C(7),SEQUENCE_000:C(3),INVOICE_TYPE:C(1),ORD_INV_FLAG:C(1),BACKORD_FLAG:C(1),INVOICE_DATE:C(3),AR_SHIP_DATE:C(3),RESERVED_STR_1:C(2),AR_SHIP_VIA:C(10),ORDER_NUMBER:C(7),AR_PO_NUMBER:C(10),SLSPSN_CODE:C(3),TERMS_CODE:C(2),DISC_CODE:C(2),DIST_CODE:C(2),ORD_PRT_FLAG:C(1),ORD_LOCK:C(1),MESSAGE_CODE:C(2),TERRITORY:C(3),LIST_PRC_CDE:C(2),ORDER_DATE:C(3),TAX_CODE:C(2),PRICING_CODE:C(4),AR_JOB_NBR:C(10),ORD_TAKEN_BY:C(3),CASH_SALE:C(1),REPRINT_FLAG:C(1),ORD_CRED_FLG:C(1),SHIPTO_NBR:C(6),RESERVED_STR_2:C(10*),TAX_AMOUNT:N(7*):MON=1:,FREIGHT_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:,COMM_PERCENT:N(7*),TAXABLE_AMT:N(7*):MON=1:,COMM_AMT:N(7*):MON=1:,TOTAL_SALES:N(7*):MON=1:,TOTAL_COST:N(7*):MON=1:,RESERVED_NUM_1:N(1*),RESERVED_NUM_2:N(1*),RESERVED_NUM_3:N(1*)"
LET xf$="ART-03"; goto FILE_OPEN

ART06: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),RESERVED_STR_1:C(1),CUSTOMER_NBR:C(6),RECEIPT_DATE:C(3),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),RESERVED_STR_2:C(1),CASH_OR_CHK:C(1),ABA_NUMBER:C(10),RESERVED_STR_3:C(10*),PAYMENT_AMT:N(7*):MON=1:"
LET xf$="ART-06"; goto FILE_OPEN

ART07: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),AR_INV_NBR:C(7),INVOICE_DATE:C(3),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),CC_OR_ABA:C(16),EXPIRE_DATE:C(3),ORDER_NUMBER:C(7*),CUST_NAME:C(30*),INVOICE_AMT:N(7*):MON=1:,TENDERED_AMT:N(7*):MON=1:"
LET xf$="ART-07"; goto FILE_OPEN

ART11: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),AR_INV_NBR:C(7),INV_SEQ_NBR:C(2*),AR_TRAN_CODE:C(1),TRANS_DATE:C(3),REF_CHK_NBR:C(7*),TRANS_AMT:N(7*):MON=1:,ADJ_DISC_AMT:N(7*):MON=1:"
LET xf$="ART-11"; goto FILE_OPEN

ART13: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),CUSTOMER_NBR:C(6),AR_INV_NBR:C(7),LINE_NUMBER:C(3),LINE_CODE:C(1),MAN_PRICE:C(1),PRODUCT_TYPE:C(3),PULL_ASSMBLE:C(1),RESERVED_STR_1:C(4),WAREHOUSE_ID:C(2),ITEM_NUMBER:C(20*),ORDER_MEMO:C(40),EST_SHP_DATE:C(3),COMMIT_FLAG:C(1),PICK_FLAG:C(1),RESERVED_STR_2:C(19*),UNIT_COST:N(7*):MON=1:,UNIT_PRICE:N(7*):MON=1:,QTY_ORDERED:N(7*),QTY_BACKORD:N(7*),QTY_SHIPPED:N(7*),STD_LIST_PRC:N(7*):MON=1:,EXT_PRICE:N(7*):MON=1:,TAXABLE_AMT:N(7*):MON=1:,DISC_PERCENT:N(7*),COMM_PERCENT:N(7*),COMM_AMT:N(7*):MON=1:,SPL_COMM_PCT:N(7*),RESERVED_NUM_1:N(1*),RESERVED_NUM_2:N(1*),RESERVED_NUM_3:N(1*)"
LET xf$="ART-13"; goto FILE_OPEN

ART16: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),RESERVED_STR_1:C(1),CUSTOMER_NBR:C(6),RECEIPT_DATE:C(3),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),RESERVED_STR_2:C(1),AR_INV_NBR:C(7),RESERVED_STR_3:C(10*),APPLY_AMT:N(7*):MON=1:,DISCOUNT_AMT:N(7*):MON=1:"
LET xf$="ART-16"; goto FILE_OPEN

ART26: 
DIM A$:"FIRM_ID:C(2),AR_TYPE:C(2),RESERVED_STR_1:C(1),CUSTOMER_NBR:C(6),RECEIPT_DATE:C(3),CASH_REC_CD:C(3),AR_CHECK_NBR:C(7),RESERVED_STR_2:C(1),gl_account:c(10):ACT=1:,RESERVED_STR_3:C(10*),GL_POST_AMT:N(7*):MON=1:,NUM1:N(1*)"
LET xf$="ART-26"; goto FILE_OPEN

GLE06: 
DIM A$:"FIRM_ID:C(2),GL_RPT_NBR:C(2),GL_RPT_LINE:C(4),GL_PCN_FLAG:C(1),GL_PQY_FLAG:C(1*),ACTUAL_AMT:N(7*):MON=1:,ACTUAL_UNITS:N(7*),BUDGET_AMT:N(7*):MON=1:,BUDGET_UNITS:N(7*)"
LET xf$="GLE-06"; goto FILE_OPEN

GLE07: 
DIM A$:"FIRM_ID:C(2),TOT_TYPE_CDE:C(1),TOTAL_NUMBER:C(3),GL_PCN_FLAG:C(1),GL_PQY_FLAG:C(1),GL_UPDT_SEQ:C(1*),ACTUAL_AMT:N(7*):MON=1:,ACTUAL_UNITS:N(7*),BUDGET_AMT:N(7*):MON=1:,BUDGET_UNITS:N(7*)"
LET xf$="GLE-07"; goto FILE_OPEN

GLE08: 
DIM A$:"FIRM_ID:C(2),GL_RPT_NBR:C(2),GL_RPT_LINE:C(4*),GL_UPDT_SEQ:C(1*),PERIOD_AMT_1:N(7*):MON=1:,PERIOD_AMT_2:N(7*):MON=1:,PERIOD_AMT_3:N(7*):MON=1:,PERIOD_AMT_4:N(7*):MON=1:,PERIOD_AMT_5:N(7*):MON=1:,PERIOD_AMT_6:N(7*):MON=1:,PERIOD_AMT_7:N(7*):MON=1:,PERIOD_AMT_8:N(7*):MON=1:,PERIOD_AMT_9:N(7*):MON=1:,PERIOD_AMT_10:N(7*):MON=1:,PERIOD_AMT_11:N(7*):MON=1:,PERIOD_AMT_12:N(7*):MON=1:,PERIOD_AMT_13:N(7*):MON=1:,PERIOD_AMT_14:N(7*):MON=1:,PERIOD_UNITS_1:N(7*),PERIOD_UNITS_2:N(7*),PERIOD_UNITS_3:N(7*),PERIOD_UNITS_4:N(7*),PERIOD_UNITS_5:N(7*),PERIOD_UNITS_6:N(7*),PERIOD_UNITS_7:N(7*),PERIOD_UNITS_8:N(7*),PERIOD_UNITS_9:N(7*),PERIOD_UNITS_10:N(7*),PERIOD_UNITS_11:N(7*),PERIOD_UNITS_12:N(7*),PERIOD_UNITS_13:N(7*),PERIOD_UNITS_14:N(7*)"
LET xf$="GLE-08"; goto FILE_OPEN

GLE09: 
DIM A$:"FIRM_ID:C(2),TOTALS_TYPE:C(1),TOTAL_NUMBER:C(3),GL_UPDT_SEQ:C(1*),PERIOD_AMT_1:N(7*):MON=1:,PERIOD_AMT_2:N(7*):MON=1:,PERIOD_AMT_3:N(7*):MON=1:,PERIOD_AMT_4:N(7*):MON=1:,PERIOD_AMT_5:N(7*):MON=1:,PERIOD_AMT_6:N(7*):MON=1:,PERIOD_AMT_7:N(7*):MON=1:,PERIOD_AMT_8:N(7*):MON=1:,PERIOD_AMT_9:N(7*):MON=1:,PERIOD_AMT_10:N(7*):MON=1:,PERIOD_AMT_11:N(7*):MON=1:,PERIOD_AMT_12:N(7*):MON=1:,PERIOD_AMT_13:N(7*):MON=1:,PERIOD_AMT_14:N(7*):MON=1:,PERIOD_UNITS_1:N(7*),PERIOD_UNITS_2:N(7*),PERIOD_UNITS_3:N(7*),PERIOD_UNITS_4:N(7*),PERIOD_UNITS_5:N(7*),PERIOD_UNITS_6:N(7*),PERIOD_UNITS_7:N(7*),PERIOD_UNITS_8:N(7*),PERIOD_UNITS_9:N(7*),PERIOD_UNITS_10:N(7*),PERIOD_UNITS_11:N(7*),PERIOD_UNITS_12:N(7*),PERIOD_UNITS_13:N(7*),PERIOD_UNITS_14:N(7*)"
LET xf$="GLE-09"; goto FILE_OPEN

GLE11: 
DIM A$:"FIRM_ID:C(2),JOURNAL_ID:C(2),JE_TRANS_ID:C(10),LINE_NUMBER:C(3*),GL_ACCOUNT:C(10*):ACT=1:,GL_POST_MEMO:C(30*),DEALER_STR:C(1*),GL_POST_AMT:N(7*):MON=1:,UNITS:N(7*),DEALER_NUM_1:N(1*),DEALER_NUM_2:N(1*),DEALER_NUM_3:N(1*)"
LET xf$="GLE-11"; goto FILE_OPEN

GLM02: 
DIM A$:"FIRM_ID:C(2),gl_account:c(10):ACT=1:,RECORD_ID:C(1*),BEGIN_AMT:N(7*):MON=1:,PERIOD_AMT_1:N(7*):MON=1:,PERIOD_AMT_2:N(7*):MON=1:,PERIOD_AMT_3:N(7*):MON=1:,PERIOD_AMT_4:N(7*):MON=1:,PERIOD_AMT_5:N(7*):MON=1:,PERIOD_AMT_6:N(7*):MON=1:,PERIOD_AMT_7:N(7*):MON=1:,PERIOD_AMT_8:N(7*):MON=1:,PERIOD_AMT_9:N(7*):MON=1:,PERIOD_AMT_10:N(7*):MON=1:,PERIOD_AMT_11:N(7*):MON=1:,PERIOD_AMT_12:N(7*):MON=1:,PERIOD_AMT_13:N(7*):MON=1:,BEGIN_UNITS:N(7*),PERIOD_UNITS_1:N(7*),PERIOD_UNITS_2:N(7*),PERIOD_UNITS_3:N(7*),PERIOD_UNITS_4:N(7*),PERIOD_UNITS_5:N(7*),PERIOD_UNITS_6:N(7*),PERIOD_UNITS_7:N(7*),PERIOD_UNITS_8:N(7*),PERIOD_UNITS_9:N(7*),PERIOD_UNITS_10:N(7*),PERIOD_UNITS_11:N(7*),PERIOD_UNITS_12:N(7*),PERIOD_UNITS_13:N(7*)"
LET xf$="GLM-02"; goto FILE_OPEN

GLT04: 
DIM A$:"FIRM_ID:C(2),JOURNAL_ID:C(2),GL_ADT_NBR:C(7),POSTING_YEAR_1:C(2),POSTING_PER_1:C(2),GL_POST_DATE:C(6),gl_account:c(10):ACT=1:,GL_POST_SEQ:C(5*),REFERENCE_1:C(10),REFERENCE_2:C(10),REFERENCE_3:C(10),GL_POST_MEMO:C(30),POSTING_PER_2:C(2),POSTING_YEAR_2:C(2*),DEALER_STR:C(1*),GL_POST_AMT:N(7*):MON=1:,UNITS:N(7*),DEALER_NUM_1:N(1*),DEALER_NUM_2:N(1*),DEALER_NUM_3:N(1*)"
LET xf$="GLT-04"; goto FILE_OPEN

GLT06: 
DIM A$:"FIRM_ID:C(2),gl_account:c(10):ACT=1:,POSTING_YEAR_1:C(2),POSTING_PER_1:C(2),GL_POST_DATE:C(6),JOURNAL_ID:C(2),GL_ADT_NBR:C(7),GL_POST_SEQ:C(5*),REFERENCE_1:C(10),REFERENCE_2:C(10),REFERENCE_3:C(10),GL_POST_MEMO:C(30),POSTING_PER_2:C(2),POSTING_YEAR_2:C(2*),DEALER_STR:C(1*),GL_POST_AMT:N(7*):MON=1:,UNITS:N(7*),DEALER_NUM_1:N(1*),DEALER_NUM_2:N(1*),DEALER_NUM_3:N(1*)"
LET xf$="GLT-06"; goto FILE_OPEN

SYS01X:
dim a$:"RECORD_ID:C(1),AVAILABLE:C(99*),EXCH_RATE:N(7*),PRECISION:N(7*),EXCH_RATE1:N(1*),NUM2:N(1*)"
LET xf$="SYS-01"; goto FILE_OPEN

FILE_OPEN: 
LET xf=UNT
OPEN (xf)path$+XF$
close(wf,err=*next)
LET wf=UNT
OPEN (wf)path$+XF$

return

file_err:
?filename$," Not found"
escape

err_routine:
IF ERR=127 THEN GOTO L9300
CALL "SYC.EA",ERR=L9090,EXIT_CTRL,PGM(-2),ERR,TCB(5),E$,E1,E2
IF E1=1 THEN GOTO L9100
IF E1=3 THEN GOTO L9200
PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
L9090: ESCAPE
L9100: REM " --- Retry"
RETRY
L9200: REM " --- Return"
GOTO eoj
L9300: REM " --- Standard Escape Routine"
CALL "SYC.ES",ERR=9350,PGM(-2),TCB(8),E$,E2,V3
IF V3<>127 THEN goto L9390
PRINT @(0,E2),'CL','CURSOR'("ON"),E$,'LF'
L9350: ESCAPE
L9390: RETURN

eoj: 
print 'pop'
exit
